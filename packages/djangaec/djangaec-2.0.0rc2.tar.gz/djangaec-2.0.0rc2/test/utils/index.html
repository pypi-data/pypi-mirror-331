<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://potato-oss.gitlab.io/djangae/djangae/utils/">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Utils - Djangae Documentation</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Utils";
    var mkdocs_page_input_path = "utils.md";
    var mkdocs_page_url = "/djangae/djangae/utils/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Djangae Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation & Deployment</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../sandbox/">Local/remote management commands</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../environment/">Environment</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Utils</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#retry">Retry</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#djangaeutilsretry">djangae.utils.retry</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#djangaeutilsretry_on_error">djangae.utils.retry_on_error</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#djangaeutilsretry_until_successful">djangae.utils.retry_until_successful</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../storage/">Storage backends</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../deferred/">Background Processing</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Contrib apps</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../googleauth/">Googleauth</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../contrib_search/">Search</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../pagination/">Pagination</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../backup/">Scheduled backups</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../security/">Security</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../locking/">Thread locking</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../contributing/">Contributing & Testing</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Djangae Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Utils</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://gitlab.com/potato-oss/djangae/djangae/edit/master/docs/utils.md"
          class="icon icon-gitlab"
        > Edit on GitLab</a>
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="environment">Environment</h1>
<p>Djangae contains a small collection of utility functions which are useful on App Engine.</p>
<h2 id="retry">Retry</h2>
<p>This is a helper for calling functions which may intermittently throw errors.
It is useful for things such as performing Datastore transactions which may collide, or calling other APIs which may occasionally fail but that should succeed on a subsequent attempt.</p>
<h3 id="djangaeutilsretry"><code>djangae.utils.retry</code></h3>
<pre><code class="language-python">retry(function, _catch=None, _attempts=3, _initial_wait=375, _max_wait=30000, _avoid_clashes=True)
</code></pre>
<p>Calls the given function, catching the given exception(s), and (re)trying up to a maximum of <code>_attempts</code> times.
If the intial call fails, it will wait <code>_initial_wait</code> milliseconds before making the second attempt.
The wait will double on each subsequent retry, up to a maximum of <code>_max_wait</code> milliseconds.</p>
<p><code>_catch</code> defaults to:</p>
<pre><code class="language-python">(
    djangae.db.transaction.TransactionFailedError,
    google.appengine.api.datastore_errors.Error,
    google.appengine.runtime.apiproxy_errors.Error
)
</code></pre>
<p>If <code>_avoid_clashes</code> is True (default) then a random time up to a second will be added after the first
retry (the retry time is still capped at <code>_max_wait</code>). This is to help avoid situations where several
tasks collide, and then all back off for the same amount of time before clashing again.</p>
<h3 id="djangaeutilsretry_on_error"><code>djangae.utils.retry_on_error</code></h3>
<p>A function decorator which routes the function through <code>retry</code>.</p>
<pre><code class="language-python">@retry_on_error(_catch=None, _attempts=3, _initial_wait=375, _max_wait=30000)
def my_function():
    ...
</code></pre>
<h3 id="djangaeutilsretry_until_successful"><code>djangae.utils.retry_until_successful</code></h3>
<pre><code class="language-pythonn">retry(function, _catch=None, _attempts=âˆž, _initial_wait=375, _max_wait=30000)
</code></pre>
<p>The same as <code>retry</code>, but <code>_attempts</code> is unlimited, so it will keep on retrying until either it succeeds or you hit an uncaught exception, such as the App Engine <code>DeadlineExceededError</code>.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../storage/" class="btn btn-neutral float-right" title="Storage backends">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../environment/" class="btn btn-neutral" title="Environment"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://gitlab.com/potato-oss/djangae/djangae/" class="icon icon-gitlab" style="color: #fcfcfc"> GitLab</a>
        </span>
    
    
      <span><a href="../environment/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../storage/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
