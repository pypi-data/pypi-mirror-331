"use strict";(self.webpackChunkjupyterlab_pausable_contextual_help=self.webpackChunkjupyterlab_pausable_contextual_help||[]).push([[931],{931:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var o=n(738),s=n(209),i=n(259),c=n(262);const r=new c.Token("@jupyterlab/inspector:IMyInspector",'A service for adding contextual help to widgets (visible using "Show Contextual Help" from the Help menu).\n  Use this to hook into the contextual help system in your extension.');var d=n(310),a=n(324),l=n(583),u=n(602);class p{constructor(e){this._cleared=new u.Signal(this),this._disposed=new u.Signal(this),this._editor=null,this._inspected=new u.Signal(this),this._isDisposed=!1,this._pending=0,this._standby=!0,this._lastInspectedReply=null,this._connector=e.connector,this._rendermime=e.rendermime,this._debouncer=new l.Debouncer(this.onEditorChange.bind(this),250)}get cleared(){return this._cleared}get disposed(){return this._disposed}get inspected(){return this._inspected}get editor(){return this._editor}set editor(e){if(e===this._editor)return;u.Signal.disconnectReceiver(this);const t=this._editor=e;t&&(this._cleared.emit(void 0),this.onEditorChange(),t.model.selections.changed.connect(this._onChange,this),t.model.sharedModel.changed.connect(this._onChange,this))}get standby(){return this._standby}set standby(e){this._standby=e}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,this._debouncer.dispose(),this._disposed.emit(void 0),u.Signal.clearData(this))}onEditorChange(e){if(this._standby)return;const t=this.editor;if(!t)return;const n=e||t.model.sharedModel.getSource(),o=t.getCursorPosition(),s=d.Text.jsIndexToCharIndex(t.getOffsetAt(o),n),i={content:null},r=++this._pending;this._connector.fetch({offset:s,text:n}).then((e=>{if(!e||this.isDisposed||r!==this._pending)return this._lastInspectedReply=null,void this._inspected.emit(i);const{data:t}=e;if(this._lastInspectedReply&&c.JSONExt.deepEqual(this._lastInspectedReply,t))return;const n=this._rendermime.preferredMimeType(t);if(n){const e=this._rendermime.createRenderer(n),o=new a.MimeModel({data:t});e.renderModel(o),i.content=e}this._lastInspectedReply=e.data,this._inspected.emit(i)})).catch((e=>{this._lastInspectedReply=null,this._inspected.emit(i)}))}_onChange(){this._debouncer.invoke()}}var h=n(625),_=n(256);const g="jp-MyInspector-content";class m extends _.Panel{constructor(e={}){super(),this._source=null,this.translator=e.translator||h.nullTranslator,this._trans=this.translator.load("jupyterlab"),e.initialContent instanceof _.Widget?this._content=e.initialContent:"string"==typeof e.initialContent?this._content=m._generateContentWidget(`<p>${e.initialContent}</p>`):this._content=m._generateContentWidget("<p>"+this._trans.__("Press F1 on a function to see documentation.")+"</p>"),this.addClass("jp-MyInspector"),this.layout.addWidget(this._content)}[s.Printing.symbol](){return()=>s.Printing.printWidget(this)}get source(){return this._source}set source(e){this._source!==e&&(this._source&&(this._source.standby=!0,this._source.inspected.disconnect(this.onMyInspectorUpdate,this),this._source.disposed.disconnect(this.onSourceDisposed,this)),e&&e.isDisposed&&(e=null),this._source=e,this._source&&(this._source.inspected.connect(this.onMyInspectorUpdate,this),this._source.disposed.connect(this.onSourceDisposed,this)))}dispose(){this.isDisposed||(this.source=null,super.dispose())}onMyInspectorUpdate(e,t){const{content:n}=t;n&&n!==this._content&&(this._content.dispose(),this._content=n,n.addClass(g),this.layout.addWidget(n))}onSourceDisposed(e,t){this.source=null}static _generateContentWidget(e){const t=new _.Widget;return t.node.innerHTML=e,t.addClass(g),t.addClass("jp-MyInspector-default-content"),t}}var y=n(781);class C extends y.DataConnector{constructor(e){super(),this._sessionContext=e.sessionContext}fetch(e){var t;const n=null===(t=this._sessionContext.session)||void 0===t?void 0:t.kernel;if(!n)return Promise.reject(new Error("Inspection fetch requires a kernel."));const o={code:e.text,cursor_pos:e.offset,detail_level:1};return n.requestInspect(o).then((e=>{const t=e.content;if("ok"!==t.status||!t.found)throw new Error("Inspection fetch failed to return successfully.");return{data:t.data,metadata:t.metadata}}))}}var b,x=n(36),f=n(123),I=n(655);!function(e){e.open="myinspector:open",e.close="myinspector:close",e.toggle="myinspector:toggle",e.trigger="myinspector:trigger",e.toggleStandby="myinspector:toggleStandby"}(b||(b={}));const v=[{id:"jupyterlab_pausable_contextual_help:myinspector",description:"Provides the pausable code introspection widget.",requires:[h.ITranslator],optional:[s.ICommandPalette,x.ILauncher,o.ILayoutRestorer],provides:r,autoStart:!0,activate:(e,t,n,o,i)=>{const c=t.load("jupyterlab"),{commands:r,shell:d}=e,a=c.__("Manually updating code documentation from the active kernel"),l=c.__("My Contextual Help"),u="jpMyInspector",p=new s.WidgetTracker({namespace:"myinspector"});function h(){return g&&!g.isDisposed}function _(){return!!(g&&g.content&&g.content.source)&&g.content.source.standby}let g,y=null;function C(e){var n;return h()||(g=new s.MainAreaWidget({content:new m({translator:t})}),g.id="jp-myinspector",g.title.label=l,g.title.icon=I.inspectorIcon,p.add(g),y=y&&!y.isDisposed?y:null,g.content.source=y,null===(n=g.content.source)||void 0===n||n.onEditorChange(e)),g.isAttached||d.add(g,"main",{activate:!1,mode:"split-right",type:"MyInspector"}),d.activateById(g.id),document.body.dataset[u]="open",g}function x(){g.dispose(),delete document.body.dataset[u]}const f=c.__("Open My Contextual Help");r.addCommand(b.open,{caption:a,isEnabled:()=>!g||g.isDisposed||!g.isAttached||!g.isVisible,label:f,icon:e=>e.isLauncher?I.inspectorIcon:void 0,execute:e=>{var t;const n=e&&e.text,o=e&&e.refresh;h()&&o?null===(t=g.content.source)||void 0===t||t.onEditorChange(n):C(n)}});const v=c.__("Hide My Contextual Help");r.addCommand(b.close,{caption:a,isEnabled:()=>h(),label:v,icon:e=>e.isLauncher?I.inspectorIcon:void 0,execute:()=>x()});const M=c.__("Show My Contextual Help");r.addCommand(b.toggle,{caption:a,label:M,isToggled:()=>h(),execute:e=>{h()?x():C(e&&e.text)}});const w=c.__("Trigger My Contextual Help");r.addCommand(b.trigger,{caption:a,isEnabled:()=>_(),label:w,execute:()=>{var e;g&&g.content&&g.content.source&&_()&&(g.content.source.standby=!1,null===(e=g.content.source)||void 0===e||e.onEditorChange(),g.content.source.standby=!0)}});const S=c.__("Auto Update My Contextual Help");return r.addCommand(b.toggleStandby,{caption:a,isToggled:()=>!_(),label:S,execute:()=>{g&&g.content&&g.content.source&&(_()?g.content.source.standby=!1:g.content.source.standby=!0)}}),o&&o.add({command:b.open,args:{isLauncher:!0}}),n&&n.addItem({command:b.toggle,category:M}),i&&i.restore(p,{command:b.toggle,name:()=>"myinspector"}),Object.defineProperty({},"source",{get:()=>!g||g.isDisposed?null:g.content.source,set:e=>{y=e&&!e.isDisposed?e:null,g&&!g.isDisposed&&(g.content.source=y)}})}},{id:"jupyterlab_pausable_contextual_help:consoles",description:"Adds my code introspection support to consoles.",requires:[r,i.IConsoleTracker,o.ILabShell],autoStart:!0,activate:(e,t,n,o,s)=>{const i={};n.widgetAdded.connect(((e,t)=>{const n=t.console.sessionContext,o=t.console.rendermime,s=new C({sessionContext:n}),c=new p({connector:s,rendermime:o});i[t.id]=c;const r=t.console.promptCell;c.editor=r&&r.editor,t.console.promptCellCreated.connect(((e,t)=>{c.editor=t&&t.editor})),t.disposed.connect((()=>{delete i[t.id],c.dispose()}))}));const c=e=>{e&&n.has(e)&&i[e.id]&&(t.source=i[e.id])};o.currentChanged.connect(((e,t)=>c(t.newValue))),e.restored.then((()=>c(o.currentWidget))),e.contextMenu.addItem({command:b.toggle,selector:".jp-CodeConsole-promptCell"}),e.contextMenu.addItem({command:b.toggleStandby,selector:".jp-CodeConsole-promptCell"})}},{id:"jupyterlab_pausable_contextual_help:notebooks",description:"Adds code introspection to notebooks.",requires:[r,f.INotebookTracker,o.ILabShell],autoStart:!0,activate:(e,t,n,o)=>{const s={};n.widgetAdded.connect(((e,t)=>{const n=t.sessionContext,o=t.content.rendermime,i=new C({sessionContext:n}),c=new p({connector:i,rendermime:o});s[t.id]=c;const r=t.content.activeCell;c.editor=r&&r.editor,t.content.activeCellChanged.connect(((e,n)=>{null==n||n.ready.then((()=>{n===t.content.activeCell&&(c.editor=n.editor)}))})),t.disposed.connect((()=>{delete s[t.id],c.dispose()}))}));const i=e=>{e&&n.has(e)&&s[e.id]&&(t.source=s[e.id])};o.currentChanged.connect(((e,t)=>i(t.newValue))),e.restored.then((()=>i(o.currentWidget))),e.contextMenu.addItem({command:b.toggle,selector:".jp-Notebook"}),e.contextMenu.addItem({command:b.toggleStandby,selector:".jp-Notebook"})}}]}}]);