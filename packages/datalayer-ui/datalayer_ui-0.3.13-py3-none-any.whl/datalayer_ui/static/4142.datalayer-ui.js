"use strict";(self.webpackChunk_datalayer_ui=self.webpackChunk_datalayer_ui||[]).push([[4142,2426],{56997:(e,t,n)=>{n.r(t),n.d(t,{DocumentEdit:()=>ut,default:()=>ht});var o=n(9387),s=n(20568),a=n(79026),i=n(97096),r=n(83278),l=n(98754),c=n(99180),d=n(93054),m=n(88996),u=n(48371),h=n(64664),p=n(38621),g=n(13375),x=n(94439),f=n(6246),C=n(4674),j=n(60083),_=n(40290),b=n(12532),y=n(46333),v=n(53439),E=n(90043),N=n(78031),k=n(45838),P=n(50337),T=n(64166),S=n(59798),w=n(70312),L=n(25035),I=n(29325),A=n(61497),B=n(43045),D=n(57804),F=n(63646),R=n(98520),O=n(85861),M=n(99526),H=n(70508),J=n(26369),z=n(12224),U=n(28661),$=n(66550),Z=n(43016),q=n(86871),K=n(8075),W=n(503),V=n(18924),Q=n(6111),G=n(63439),Y=n(59910),X=n(40942),ee=n(20794),te=n(70315),ne=n(94789);const oe={characterLimit:"PlaygroundEditorTheme__characterLimit",code:"PlaygroundEditorTheme__code",codeHighlight:{atrule:"PlaygroundEditorTheme__tokenAttr",attr:"PlaygroundEditorTheme__tokenAttr",boolean:"PlaygroundEditorTheme__tokenProperty",builtin:"PlaygroundEditorTheme__tokenSelector",cdata:"PlaygroundEditorTheme__tokenComment",char:"PlaygroundEditorTheme__tokenSelector",class:"PlaygroundEditorTheme__tokenFunction","class-name":"PlaygroundEditorTheme__tokenFunction",comment:"PlaygroundEditorTheme__tokenComment",constant:"PlaygroundEditorTheme__tokenProperty",deleted:"PlaygroundEditorTheme__tokenProperty",doctype:"PlaygroundEditorTheme__tokenComment",entity:"PlaygroundEditorTheme__tokenOperator",function:"PlaygroundEditorTheme__tokenFunction",important:"PlaygroundEditorTheme__tokenVariable",inserted:"PlaygroundEditorTheme__tokenSelector",keyword:"PlaygroundEditorTheme__tokenAttr",namespace:"PlaygroundEditorTheme__tokenVariable",number:"PlaygroundEditorTheme__tokenProperty",operator:"PlaygroundEditorTheme__tokenOperator",prolog:"PlaygroundEditorTheme__tokenComment",property:"PlaygroundEditorTheme__tokenProperty",punctuation:"PlaygroundEditorTheme__tokenPunctuation",regex:"PlaygroundEditorTheme__tokenVariable",selector:"PlaygroundEditorTheme__tokenSelector",string:"PlaygroundEditorTheme__tokenSelector",symbol:"PlaygroundEditorTheme__tokenProperty",tag:"PlaygroundEditorTheme__tokenProperty",url:"PlaygroundEditorTheme__tokenOperator",variable:"PlaygroundEditorTheme__tokenVariable"},embedBlock:{base:"PlaygroundEditorTheme__embedBlock",focus:"PlaygroundEditorTheme__embedBlockFocus"},hashtag:"PlaygroundEditorTheme__hashtag",heading:{h1:"PlaygroundEditorTheme__h1",h2:"PlaygroundEditorTheme__h2",h3:"PlaygroundEditorTheme__h3",h4:"PlaygroundEditorTheme__h4",h5:"PlaygroundEditorTheme__h5",h6:"PlaygroundEditorTheme__h6"},image:"editor-image",link:"PlaygroundEditorTheme__link",list:{listitem:"PlaygroundEditorTheme__listItem",listitemChecked:"PlaygroundEditorTheme__listItemChecked",listitemUnchecked:"PlaygroundEditorTheme__listItemUnchecked",nested:{listitem:"PlaygroundEditorTheme__nestedListItem"},olDepth:["PlaygroundEditorTheme__ol1","PlaygroundEditorTheme__ol2","PlaygroundEditorTheme__ol3","PlaygroundEditorTheme__ol4","PlaygroundEditorTheme__ol5"],ul:"PlaygroundEditorTheme__ul"},ltr:"PlaygroundEditorTheme__ltr",mark:"PlaygroundEditorTheme__mark",markOverlap:"PlaygroundEditorTheme__markOverlap",paragraph:"PlaygroundEditorTheme__paragraph",quote:"PlaygroundEditorTheme__quote",rtl:"PlaygroundEditorTheme__rtl",table:"PlaygroundEditorTheme__table",tableCell:"PlaygroundEditorTheme__tableCell",tableCellHeader:"PlaygroundEditorTheme__tableCellHeader",text:{bold:"PlaygroundEditorTheme__textBold",code:"PlaygroundEditorTheme__textCode",italic:"PlaygroundEditorTheme__textItalic",strikethrough:"PlaygroundEditorTheme__textStrikethrough",subscript:"PlaygroundEditorTheme__textSubscript",superscript:"PlaygroundEditorTheme__textSuperscript",underline:"PlaygroundEditorTheme__textUnderline",underlineStrikethrough:"PlaygroundEditorTheme__textUnderlineStrikethrough"}};var se=n(45222),ae=n(48832),ie=n(27639),re=n(73105),le=n(96020),ce=n(18683);const de=function(){const e=[];for(const[t,n]of Object.entries(F.mF))e.push([t,n]);return e}(),me=new Set(["paragraph","quote","code","h1","h2","ul","ol"]),ue={code:"Code Block",h1:"Large Heading",h2:"Small Heading",h3:"Heading",h4:"Heading",h5:"Heading",ol:"Numbered List",paragraph:"Normal",quote:"Quote",ul:"Bulleted List"};function he(){return(0,ce.jsx)("div",{className:"divider"})}function pe(e,t){null===t?(e.style.opacity="0",e.style.top="-1000px",e.style.left="-1000px"):(e.style.opacity="1",e.style.top=`${t.top+t.height+window.pageYOffset+10}px`,e.style.left=t.left+window.pageXOffset-e.offsetWidth/2+t.width/2+"px")}function ge({editor:e}){const t=(0,o.useRef)(null),n=(0,o.useRef)(null),s=(0,o.useRef)(!1),[a,i]=(0,o.useState)(""),[r,l]=(0,o.useState)(!1),[c,d]=(0,o.useState)(null),m=(0,o.useCallback)((()=>{const n=(0,ae.vJ)();if((0,ae.I2)(n)){const e=xe(n),t=e.getParent();(0,A.FJ)(t)?i(t.getURL()):(0,A.FJ)(e)?i(e.getURL()):i("")}const o=t.current,a=window.getSelection(),r=document.activeElement;if(null===o)return;const c=e.getRootElement();if(null!==n&&!a?.isCollapsed&&null!==c&&c.contains(a?.anchorNode)){const e=a?.getRangeAt(0);let t;if(a?.anchorNode===c){let e=c;for(;null!=e.firstElementChild;)e=e.firstElementChild;t=e.getBoundingClientRect()}else t=e?.getBoundingClientRect();s.current||pe(o,t),d(n)}else r&&"link-input"===r.className||(pe(o,null),d(null),l(!1),i(""));return!0}),[e]);return(0,o.useEffect)((()=>(0,re.Sd)(e.registerUpdateListener((({editorState:e})=>{e.read((()=>{m()}))})),e.registerCommand(ae.Mv,(()=>(m(),!0)),1))),[e,m]),(0,o.useEffect)((()=>{e.getEditorState().read((()=>{m()}))}),[e,m]),(0,o.useEffect)((()=>{r&&n.current&&n.current.focus()}),[r]),(0,ce.jsx)("div",{ref:t,className:"link-editor",children:r?(0,ce.jsx)("input",{ref:n,className:"link-input",value:a,onChange:e=>{i(e.target.value)},onKeyDown:t=>{"Enter"===t.key?(t.preventDefault(),null!==c&&(""!==a&&e.dispatchCommand(A.yW,a),l(!1))):"Escape"===t.key&&(t.preventDefault(),l(!1))}}):(0,ce.jsx)(ce.Fragment,{children:(0,ce.jsxs)("div",{className:"link-input",children:[(0,ce.jsx)("a",{href:a,target:"_blank",rel:"noopener noreferrer",children:a}),(0,ce.jsx)("div",{className:"link-edit",role:"button",tabIndex:0,onMouseDown:e=>e.preventDefault(),onClick:()=>{l(!0)}})]})})})}function xe(e){const t=e.anchor,n=e.focus,o=e.anchor.getNode(),s=e.focus.getNode();return o===s?o:e.isBackward()?(0,ie.Nx)(n)?o:s:(0,ie.Nx)(t)?s:o}function fe({editor:e,blockType:t,toolbarRef:n,setShowBlockOptionsDropDown:s}){const a=(0,o.useRef)(null);return(0,o.useEffect)((()=>{const e=n.current,t=a.current;if(null!==e&&null!==t){const{top:n,left:o}=e.getBoundingClientRect();t.style.top=`${n+40}px`,t.style.left=`${o}px`}}),[a,n]),(0,o.useEffect)((()=>{const e=a.current,t=n.current;if(null!==e&&null!==t){const n=n=>{const o=n.target;e.contains(o)||t.contains(o)||s(!1)};return document.addEventListener("click",n),()=>{document.removeEventListener("click",n)}}}),[a,s,n]),(0,ce.jsxs)("div",{className:"dropdown",ref:a,children:[(0,ce.jsxs)("button",{className:"item",onClick:()=>{"jupyter-output"!==t&&e.update((()=>{const t=(0,ae.vJ)(),n=t?.getTextContent()||"";e.dispatchCommand(Z.JO,{code:n,outputs:n?[]:$.Cc})})),s(!1)},children:[(0,ce.jsx)("span",{className:"icon code"}),(0,ce.jsx)("span",{className:"text",children:"Jupyter Cell"}),"jupyter"===t&&(0,ce.jsx)("span",{className:"active"})]}),(0,ce.jsxs)("button",{className:"item",onClick:()=>{"paragraph"!==t&&e.update((()=>{const e=(0,ae.vJ)();(0,ae.I2)(e)&&(0,ie.AH)(e,(()=>(0,ae.lJ)()))})),s(!1)},children:[(0,ce.jsx)("span",{className:"icon paragraph"}),(0,ce.jsx)("span",{className:"text",children:"Normal"}),"paragraph"===t&&(0,ce.jsx)("span",{className:"active"})]}),(0,ce.jsxs)("button",{className:"item",onClick:()=>{"h1"!==t&&e.update((()=>{const e=(0,ae.vJ)();(0,ae.I2)(e)&&(0,ie.AH)(e,(()=>(0,w.fi)("h1")))})),s(!1)},children:[(0,ce.jsx)("span",{className:"icon large-heading"}),(0,ce.jsx)("span",{className:"text",children:"Large Heading"}),"h1"===t&&(0,ce.jsx)("span",{className:"active"})]}),(0,ce.jsxs)("button",{className:"item",onClick:()=>{"h2"!==t&&e.update((()=>{const e=(0,ae.vJ)();(0,ae.I2)(e)&&(0,ie.AH)(e,(()=>(0,w.fi)("h2")))})),s(!1)},children:[(0,ce.jsx)("span",{className:"icon small-heading"}),(0,ce.jsx)("span",{className:"text",children:"Small Heading"}),"h2"===t&&(0,ce.jsx)("span",{className:"active"})]}),(0,ce.jsxs)("button",{className:"item",onClick:()=>{"ul"!==t?e.dispatchCommand(I.q7):e.dispatchCommand(I.uS),s(!1)},children:[(0,ce.jsx)("span",{className:"icon bullet-list"}),(0,ce.jsx)("span",{className:"text",children:"Bullet List"}),"ul"===t&&(0,ce.jsx)("span",{className:"active"})]}),(0,ce.jsxs)("button",{className:"item",onClick:()=>{"ol"!==t?e.dispatchCommand(I.x):e.dispatchCommand(I.uS),s(!1)},children:[(0,ce.jsx)("span",{className:"icon numbered-list"}),(0,ce.jsx)("span",{className:"text",children:"Numbered List"}),"ol"===t&&(0,ce.jsx)("span",{className:"active"})]}),(0,ce.jsxs)("button",{className:"item",onClick:()=>{"quote"!==t&&e.update((()=>{const e=(0,ae.vJ)();(0,ae.I2)(e)&&(0,ie.AH)(e,(()=>(0,w.xi)()))})),s(!1)},children:[(0,ce.jsx)("span",{className:"icon quote"}),(0,ce.jsx)("span",{className:"text",children:"Quote"}),"quote"===t&&(0,ce.jsx)("span",{className:"active"})]}),(0,ce.jsxs)("button",{className:"item",onClick:()=>{"youtube"!==t&&e.update((()=>{const e=(0,ae.vJ)();if((0,ae.I2)(e)){const t=e.getTextContent().split("v=");e.removeText(),(0,re.Pe)((0,H.YJ)(t[t.length-1]))}})),s(!1)},children:[(0,ce.jsx)("i",{className:"icon youtube"}),(0,ce.jsx)("span",{className:"text",children:"YouTube Video"}),"youtube"===t&&(0,ce.jsx)("span",{className:"active"})]}),(0,ce.jsxs)("button",{className:"item",onClick:()=>{"equation"!==t&&e.update((()=>{const t=(0,ae.vJ)();if((0,ae.I2)(t)){const n=t.getTextContent().replaceAll("$","");t.removeText(),e.dispatchCommand(K.x,{equation:n,inline:!0})}})),s(!1)},children:[(0,ce.jsx)("i",{className:"icon equation"}),(0,ce.jsx)("span",{className:"text",children:"Equation"}),"equation"===t&&(0,ce.jsx)("span",{className:"active"})]})]})}function Ce(){const[e]=(0,x.DF)(),[t,n]=(0,o.useState)(e),s=(0,o.useRef)(null),[a,i]=(0,o.useState)(!1),[r,l]=(0,o.useState)(!1),[c,d]=(0,o.useState)("paragraph"),[m,u]=(0,o.useState)(null),[h,p]=(0,o.useState)(!1),[g,f]=(0,o.useState)(""),[C,j]=(0,o.useState)(!1),[_,b]=(0,o.useState)(!1),[y,v]=(0,o.useState)(!1),[E,N]=(0,o.useState)(!1),[k,P]=(0,o.useState)(!1),[T,S]=(0,o.useState)(!1),[L,B]=(0,o.useState)(!1),R=(0,o.useCallback)((()=>{const t=(0,ae.vJ)();if((0,ae.I2)(t)){const n=t.anchor.getNode(),o="root"===n.getKey()?n:n.getTopLevelElementOrThrow(),s=o.getKey();if(null!==e.getElementByKey(s))if(u(s),(0,I.HY)(o)){const e=(0,re.eu)(n,I.v5),t=e?e.getTag():o.getTag();d(t)}else{const e=(0,w.Pi)(o)?o.getTag():o.getType();d(e),(0,D.x_)(o)&&f(o.getLanguage()||(0,F.z8)())}v(t.hasFormat("bold")),N(t.hasFormat("italic")),P(t.hasFormat("underline")),S(t.hasFormat("strikethrough")),B(t.hasFormat("code")),j((0,ie.LP)(t));const a=xe(t),i=a.getParent();(0,A.FJ)(i)||(0,A.FJ)(a)?b(!0):b(!1)}}),[e]);(0,o.useEffect)((()=>(0,re.Sd)(e.registerUpdateListener((({editorState:e})=>{e.read((()=>{R()}))})),e.registerCommand(ae.Mv,((e,t)=>(R(),!1)),1),e.registerCommand(ae.Kf,(e=>(i(e),!1)),1),e.registerCommand(ae.WW,(e=>(l(e),!1)),1))),[e,R]),(0,o.useMemo)((()=>(0,F.r9)()),[]);const O=(0,o.useCallback)((e=>{t.update((()=>{if(null!==m){const t=(0,ae.ns)(m);(0,D.x_)(t)&&t.setLanguage(e)}}))}),[t,m]),M=(0,o.useCallback)((()=>{_?e.dispatchCommand(A.yW,null):e.dispatchCommand(A.yW,"https://")}),[e,_]);return(0,ce.jsxs)("div",{className:"toolbar",ref:s,children:[(0,ce.jsx)("button",{disabled:!a,onClick:()=>{e.dispatchCommand(ae.ZK,void 0)},className:"toolbar-item spaced","aria-label":"Undo",children:(0,ce.jsx)("i",{className:"format undo"})}),(0,ce.jsx)("button",{disabled:!r,onClick:()=>{e.dispatchCommand(ae.V3,void 0)},className:"toolbar-item","aria-label":"Redo",children:(0,ce.jsx)("i",{className:"format redo"})}),(0,ce.jsx)(he,{}),me.has(c)&&(0,ce.jsxs)(ce.Fragment,{children:[(0,ce.jsxs)("button",{className:"toolbar-item block-controls",onClick:()=>p(!h),"aria-label":"Formatting Options",children:[(0,ce.jsx)("span",{className:"icon block-type "+c}),(0,ce.jsx)("span",{className:"text",children:ue[c]}),(0,ce.jsx)("i",{className:"chevron-down"})]}),h&&(0,se.createPortal)((0,ce.jsx)(fe,{editor:e,blockType:c,toolbarRef:s,setShowBlockOptionsDropDown:p}),document.body),(0,ce.jsx)(he,{})]}),"jupyter-code"===c?(0,ce.jsx)(ce.Fragment,{children:(0,ce.jsx)(le.Ck,{buttonClassName:"toolbar-item code-language",buttonLabel:(0,F.$D)(g),buttonAriaLabel:"Select language",children:de.map((([e,t])=>{return(0,ce.jsx)(le.Ho,{className:"item "+(n=e===g,n?"active dropdown-item-active":""),onClick:()=>O(e),children:(0,ce.jsx)("span",{className:"text",children:t})},e);var n}))})}):(0,ce.jsxs)(ce.Fragment,{children:[(0,ce.jsx)("button",{onClick:()=>{e.dispatchCommand(ae.mB,"bold")},className:"toolbar-item spaced "+(y?"active":""),"aria-label":"Format Bold",children:(0,ce.jsx)("i",{className:"format bold"})}),(0,ce.jsx)("button",{onClick:()=>{e.dispatchCommand(ae.mB,"italic")},className:"toolbar-item spaced "+(E?"active":""),"aria-label":"Format Italics",children:(0,ce.jsx)("i",{className:"format italic"})}),(0,ce.jsx)("button",{onClick:()=>{e.dispatchCommand(ae.mB,"underline")},className:"toolbar-item spaced "+(k?"active":""),"aria-label":"Format Underline",children:(0,ce.jsx)("i",{className:"format underline"})}),(0,ce.jsx)("button",{onClick:()=>{e.dispatchCommand(ae.mB,"strikethrough")},className:"toolbar-item spaced "+(T?"active":""),"aria-label":"Format Strikethrough",children:(0,ce.jsx)("i",{className:"format strikethrough"})}),(0,ce.jsx)("button",{onClick:()=>{e.dispatchCommand(ae.mB,"code")},className:"toolbar-item spaced "+(L?"active":""),"aria-label":"Insert Code",children:(0,ce.jsx)("i",{className:"format code"})}),(0,ce.jsx)("button",{onClick:M,className:"toolbar-item spaced "+(_?"active":""),"aria-label":"Insert Link",children:(0,ce.jsx)("i",{className:"format link"})}),_&&(0,se.createPortal)((0,ce.jsx)(ge,{editor:e}),document.body),(0,ce.jsx)(he,{}),(0,ce.jsx)("button",{onClick:()=>{e.dispatchCommand(ae.fU,"left")},className:"toolbar-item spaced","aria-label":"Left Align",children:(0,ce.jsx)("i",{className:"format left-align"})}),(0,ce.jsx)("button",{onClick:()=>{e.dispatchCommand(ae.fU,"center")},className:"toolbar-item spaced","aria-label":"Center Align",children:(0,ce.jsx)("i",{className:"format center-align"})}),(0,ce.jsx)("button",{onClick:()=>{e.dispatchCommand(ae.fU,"right")},className:"toolbar-item spaced","aria-label":"Right Align",children:(0,ce.jsx)("i",{className:"format right-align"})}),(0,ce.jsx)("button",{onClick:()=>{e.dispatchCommand(ae.fU,"justify")},className:"toolbar-item","aria-label":"Justify Align",children:(0,ce.jsx)("i",{className:"format justify-align"})})," "]})]})}var je=n(3741),_e=n(37744),be=n(64475),ye=n(85745),ve=n(71476),Ee=n(66899),Ne=n(9366);function ke(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pe(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5)}function Te(e,t,n,o,s){return{author:t,content:e,deleted:void 0!==s&&s,id:void 0===n?Pe():n,timeStamp:void 0===o?performance.now():o,type:"comment"}}function Se(e,t,n){return{comments:t,id:void 0===n?Pe():n,quote:e,type:"thread"}}function we(e){return{comments:Array.from(e.comments),id:e.id,quote:e.quote,type:"thread"}}function Le(e){const t=e._changeListeners;for(const e of t)e()}class Ie{constructor(e){ke(this,"_editor",void 0),ke(this,"_comments",void 0),ke(this,"_changeListeners",void 0),ke(this,"_collabProvider",void 0),this._comments=[],this._editor=e,this._collabProvider=null,this._changeListeners=new Set}isCollaborative(){return null!==this._collabProvider}getComments(){return this._comments}addComment(e,t,n){const o=Array.from(this._comments),s=this._getCollabComments();if(void 0!==t&&"comment"===e.type)for(let a=0;a<o.length;a++){const i=o[a];if("thread"===i.type&&i.id===t.id){const t=we(i);o.splice(a,1,t);const r=void 0!==n?n:t.comments.length;if(this.isCollaborative()&&null!==s){const t=s.get(a).get("comments");this._withRemoteTransaction((()=>{const n=this._createCollabSharedMap(e);t.insert(r,[n])}))}t.comments.splice(r,0,e);break}}else{const t=void 0!==n?n:o.length;this.isCollaborative()&&null!==s&&this._withRemoteTransaction((()=>{const n=this._createCollabSharedMap(e);s.insert(t,[n])})),o.splice(t,0,e)}this._comments=o,Le(this)}deleteCommentOrThread(e,t){const n=Array.from(this._comments),o=this._getCollabComments();let s=null;if(void 0!==t)for(let a=0;a<n.length;a++){const i=n[a];if("thread"===i.type&&i.id===t.id){const t=we(i);n.splice(a,1,t);const r=t.comments;if(s=r.indexOf(e),this.isCollaborative()&&null!==o){const e=o.get(a).get("comments");this._withRemoteTransaction((()=>{e.delete(s)}))}r.splice(s,1);break}}else s=n.indexOf(e),this.isCollaborative()&&null!==o&&this._withRemoteTransaction((()=>{o.delete(s)})),n.splice(s,1);return this._comments=n,Le(this),"comment"===e.type?{index:s,markedComment:(a=e,{author:a.author,content:"[Deleted Comment]",deleted:!0,id:a.id,timeStamp:a.timeStamp,type:"comment"})}:null;var a}registerOnChange(e){const t=this._changeListeners;return t.add(e),()=>{t.delete(e)}}_withRemoteTransaction(e){const t=this._collabProvider;null!==t&&t.doc.transact(e,this)}_withLocalTransaction(e){const t=this._collabProvider;try{this._collabProvider=null,e()}finally{this._collabProvider=t}}_getCollabComments(){const e=this._collabProvider;return null!==e?e.doc.get("comments",Ne.O3):null}_createCollabSharedMap(e){const t=new Ne.T5,n=e.type,o=e.id;if(t.set("type",n),t.set("id",o),"comment"===n)t.set("author",e.author),t.set("content",e.content),t.set("deleted",e.deleted),t.set("timeStamp",e.timeStamp);else{t.set("quote",e.quote);const n=new Ne.O3;e.comments.forEach(((e,t)=>{const o=this._createCollabSharedMap(e);n.insert(t,[o])})),t.set("comments",n)}return t}registerCollaboration(e){this._collabProvider=e;const t=this._getCollabComments(),n=()=>{e.connect()},o=()=>{try{e.disconnect()}catch(e){}},s=this._editor.registerCommand(Ee.KL,(e=>(void 0!==n&&void 0!==o&&(e?(console.log("Comments connected!"),n()):(console.log("Comments disconnected!"),o())),!1)),ae.Ac),a=(e,n)=>{if(n.origin!==this)for(let n=0;n<e.length;n++){const o=e[n];if(o instanceof Ne.nA){const e=o.target,n=o.delta;let s=0;for(let o=0;o<n.length;o++){const a=n[o],i=a.insert,r=a.retain,l=a.delete,c=e.parent,d=e===t?void 0:c instanceof Ne.T5&&this._comments.find((e=>e.id===c.get("id")));if(Array.isArray(i))i.forEach((e=>{const t=e.get("id"),n="thread"===e.get("type")?Se(e.get("quote"),e.get("comments").toArray().map((e=>Te(e.get("content"),e.get("author"),e.get("id"),e.get("timeStamp"),e.get("deleted")))),t):Te(e.get("content"),e.get("author"),t,e.get("timeStamp"),e.get("deleted"));this._withLocalTransaction((()=>{this.addComment(n,d,s)}))}));else if("number"==typeof r)s+=r;else if("number"==typeof l)for(let e=0;e<l;e++){const e=void 0===d||!1===d?this._comments[s]:d.comments[s];this._withLocalTransaction((()=>{this.deleteCommentOrThread(e,d)})),s++}}}}};return null===t?()=>null:(t.observeDeep(a),n(),()=>{t.unobserveDeep(a),s(),this._collabProvider=null})}}var Ae=n(83632),Be=n(18478),De=n(33524),Fe=n(85408);const Re={...oe,paragraph:"CommentEditorTheme__paragraph"},Oe=(0,ae.gu)();function Me({anchorKey:e,editor:t,onAddComment:n}){const s=(0,o.useRef)(null),a=(0,o.useCallback)((()=>{const n=s.current,o=t.getRootElement(),a=t.getElementByKey(e);if(null!==n&&null!==o&&null!==a){const{right:e}=o.getBoundingClientRect(),{top:t}=a.getBoundingClientRect();n.style.left=e-20+"px",n.style.top=t-30+"px"}}),[e,t]);return(0,o.useEffect)((()=>(window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)})),[t,a]),(0,ve.d)((()=>{a()}),[e,t,a]),(0,ce.jsx)("div",{className:"CommentPlugin_AddCommentBox",ref:s,children:(0,ce.jsx)("button",{className:"CommentPlugin_AddCommentBox_button",onClick:n,children:(0,ce.jsx)("i",{className:"icon add-comment"})})})}function He({editorRef:e}){const[t]=(0,x.DF)();return(0,ve.d)((()=>(e.current=t,()=>{e.current=null})),[t,e]),null}function Je({onEscape:e}){const[t]=(0,x.DF)();return(0,o.useEffect)((()=>t.registerCommand(ae.Q$,(t=>e(t)),2)),[t,e]),null}function ze({className:e,autoFocus:t,onEscape:n,onChange:o,editorRef:s,placeholder:a="Type a comment..."}){const i={namespace:"Commenting",nodes:[],onError:e=>{throw e},theme:Re};return(0,ce.jsx)(f.n,{initialConfig:i,children:(0,ce.jsxs)("div",{className:"CommentPlugin_CommentInputBox_EditorContainer",children:[(0,ce.jsx)(be.h,{contentEditable:(0,ce.jsx)(De.e,{className:e}),placeholder:(0,ce.jsx)(Fe.O,{children:a}),ErrorBoundary:S.A}),(0,ce.jsx)(k.D,{onChange:o}),(0,ce.jsx)(_.G,{}),!1!==t&&(0,ce.jsx)(b.x,{}),(0,ce.jsx)(Je,{onEscape:n}),(0,ce.jsx)(je.Q,{}),void 0!==s&&(0,ce.jsx)(He,{editorRef:s})]})})}function Ue(e,t){return(0,o.useCallback)(((n,o)=>{n.read((()=>{e((0,ye.n$)()),t(!(0,ye.QY)(o.isComposing(),!0))}))}),[t,e])}function $e({editor:e,cancelAddComment:t,submitAddComment:n}){const[s,a]=(0,o.useState)(""),[i,r]=(0,o.useState)(!1),l=(0,o.useRef)(null),c=(0,o.useMemo)((()=>({container:document.createElement("div"),elements:[]})),[]),d=Qe(),m=(0,o.useCallback)((()=>{e.getEditorState().read((()=>{const t=(0,ae.vJ)();if((0,ae.I2)(t)){const n=t.anchor,o=t.focus,s=(0,ie.cb)(e,n.getNode(),n.offset,o.getNode(),o.offset),a=l.current;if(null!==s&&null!==a){const{left:t,bottom:n,width:o}=s.getBoundingClientRect(),i=(0,ie.zT)(e,s);let r=1===i.length?t+o/2-125:t-125;r<10&&(r=10),a.style.left=`${r}px`,a.style.top=`${n+20}px`;const l=i.length,{container:d}=c,m=c.elements,u=m.length;for(let e=0;e<l;e++){const t=i[e];let n=m[e];void 0===n&&(n=document.createElement("span"),m[e]=n,d.appendChild(n));const o="255, 212, 0",s=`position:absolute;top:${t.top}px;left:${t.left}px;height:${t.height}px;width:${t.width}px;background-color:rgba(${o}, 0.3);pointer-events:none;z-index:5;`;n.style.cssText=s}for(let e=u-1;e>=l;e--){const t=m[e];d.removeChild(t),m.pop()}}}}))}),[e,c]);(0,ve.d)((()=>{m();const e=c.container,t=document.body;if(null!==t)return t.appendChild(e),()=>{t.removeChild(e)}}),[c.container,m]),(0,o.useEffect)((()=>(window.addEventListener("resize",m),()=>{window.removeEventListener("resize",m)})),[m]);const u=Ue(a,r);return(0,ce.jsxs)("div",{className:"CommentPlugin_CommentInputBox",ref:l,children:[(0,ce.jsx)(ze,{className:"CommentPlugin_CommentInputBox_Editor",onEscape:e=>(e.preventDefault(),t(),!0),onChange:u}),(0,ce.jsxs)("div",{className:"CommentPlugin_CommentInputBox_Buttons",children:[(0,ce.jsx)(Be.$,{onClick:t,className:"CommentPlugin_CommentInputBox_Button",children:"Cancel"}),(0,ce.jsx)(Be.$,{onClick:()=>{if(i){let t=e.getEditorState().read((()=>{const e=(0,ae.vJ)();return null!==e?e.getTextContent():""}));t.length>100&&(t=t.slice(0,99)+"…"),n(Se(t,[Te(s,d)]),!0)}},disabled:!i,className:"CommentPlugin_CommentInputBox_Button primary",children:"Comment"})]})]})}function Ze({submitAddComment:e,thread:t,placeholder:n}){const[s,a]=(0,o.useState)(""),[i,r]=(0,o.useState)(!1),l=(0,o.useRef)(null),c=Qe(),d=Ue(a,r);return(0,ce.jsxs)(ce.Fragment,{children:[(0,ce.jsx)(ze,{className:"CommentPlugin_CommentsPanel_Editor",autoFocus:!1,onEscape:()=>!0,onChange:d,editorRef:l,placeholder:n}),(0,ce.jsx)(Be.$,{className:"CommentPlugin_CommentsPanel_SendButton",onClick:()=>{if(i){e(Te(s,c),!1,t);const n=l.current;null!==n&&n.dispatchCommand(ae.SK,void 0)}},disabled:!i,children:(0,ce.jsx)("i",{className:"send"})})]})}function qe({commentOrThread:e,deleteCommentOrThread:t,onClose:n,thread:o}){return(0,ce.jsxs)(ce.Fragment,{children:["Are you sure you want to delete this ",e.type,"?",(0,ce.jsxs)("div",{className:"Modal__content",children:[(0,ce.jsx)(Be.$,{onClick:()=>{t(e,o),n()},children:"Delete"})," ",(0,ce.jsx)(Be.$,{onClick:()=>{n()},children:"Cancel"})]})]})}function Ke({comment:e,deleteComment:t,thread:n,rtf:o}){const s=Math.round((e.timeStamp-performance.now())/1e3),a=Math.round(s/60),[i,r]=(0,Ae.h)();return(0,ce.jsxs)("li",{className:"CommentPlugin_CommentsPanel_List_Comment",children:[(0,ce.jsxs)("div",{className:"CommentPlugin_CommentsPanel_List_Details",children:[(0,ce.jsx)("span",{className:"CommentPlugin_CommentsPanel_List_Comment_Author",children:e.author}),(0,ce.jsxs)("span",{className:"CommentPlugin_CommentsPanel_List_Comment_Time",children:["· ",s>-10?"Just now":o.format(a,"minute")]})]}),(0,ce.jsx)("p",{className:e.deleted?"CommentPlugin_CommentsPanel_DeletedComment":"",children:e.content}),!e.deleted&&(0,ce.jsxs)(ce.Fragment,{children:[(0,ce.jsx)(Be.$,{onClick:()=>{r("Delete Comment",(o=>(0,ce.jsx)(qe,{commentOrThread:e,deleteCommentOrThread:t,thread:n,onClose:o})))},className:"CommentPlugin_CommentsPanel_List_DeleteButton",children:(0,ce.jsx)("i",{className:"delete"})}),i]})]})}function We({activeIDs:e,comments:t,deleteCommentOrThread:n,listRef:s,submitAddComment:a,markNodeMap:i}){const[r]=(0,x.DF)(),[l,c]=(0,o.useState)(0),[d,m]=(0,Ae.h)(),u=(0,o.useMemo)((()=>new Intl.RelativeTimeFormat("en",{localeMatcher:"best fit",numeric:"auto",style:"short"})),[]);return(0,o.useEffect)((()=>{const e=setTimeout((()=>{c(l+1)}),1e4);return()=>{clearTimeout(e)}}),[l]),(0,ce.jsx)("ul",{className:"CommentPlugin_CommentsPanel_List",ref:s,children:t.map((t=>{const o=t.id;if("thread"===t.type){const s=()=>{const t=i.get(o);if(void 0!==t&&(null===e||-1===e.indexOf(o))){const e=document.activeElement;r.update((()=>{const e=Array.from(t)[0],n=(0,ae.ns)(e);(0,ne.I0)(n)&&n.selectStart()}),{onUpdate(){null!==e&&e.focus()}})}};return(0,ce.jsxs)("li",{onClick:s,className:`CommentPlugin_CommentsPanel_List_Thread ${i.has(o)?"interactive":""} ${-1===e.indexOf(o)?"":"active"}`,children:[(0,ce.jsxs)("div",{className:"CommentPlugin_CommentsPanel_List_Thread_QuoteBox",children:[(0,ce.jsxs)("blockquote",{className:"CommentPlugin_CommentsPanel_List_Thread_Quote",children:["> ",(0,ce.jsx)("span",{children:t.quote})]}),(0,ce.jsx)(Be.$,{onClick:()=>{m("Delete Thread",(e=>(0,ce.jsx)(qe,{commentOrThread:t,deleteCommentOrThread:n,onClose:e})))},className:"CommentPlugin_CommentsPanel_List_DeleteButton",children:(0,ce.jsx)("i",{className:"delete"})}),d]}),(0,ce.jsx)("ul",{className:"CommentPlugin_CommentsPanel_List_Thread_Comments",children:t.comments.map((e=>(0,ce.jsx)(Ke,{comment:e,deleteComment:n,thread:t,rtf:u},e.id)))}),(0,ce.jsx)("div",{className:"CommentPlugin_CommentsPanel_List_Thread_Editor",children:(0,ce.jsx)(Ze,{submitAddComment:a,thread:t,placeholder:"Reply to comment..."})})]},o)}return(0,ce.jsx)(Ke,{comment:t,deleteComment:n,rtf:u},o)}))})}function Ve({activeIDs:e,deleteCommentOrThread:t,comments:n,submitAddComment:s,markNodeMap:a}){const i=(0,o.useRef)(null),r=0===n.length;return(0,ce.jsxs)("div",{className:"CommentPlugin_CommentsPanel",children:[(0,ce.jsx)("h2",{className:"CommentPlugin_CommentsPanel_Heading",children:"Comments"}),r?(0,ce.jsx)("div",{className:"CommentPlugin_CommentsPanel_Empty",children:"No Comments"}):(0,ce.jsx)(We,{activeIDs:e,comments:n,deleteCommentOrThread:t,listRef:i,submitAddComment:s,markNodeMap:a})]})}function Qe(){const e=(0,_e.k)(),{yjsDocMap:t,name:n}=e;return t.has("comments")?n:"Playground User"}function Ge({providerFactory:e}){const t=(0,_e.k)(),[n]=(0,x.DF)(),s=(0,o.useMemo)((()=>new Ie(n)),[n]),a=function(e){const[t,n]=(0,o.useState)(e.getComments());return(0,o.useEffect)((()=>e.registerOnChange((()=>{n(e.getComments())}))),[e]),t}(s),i=(0,o.useMemo)((()=>new Map),[]),[r,l]=(0,o.useState)(),[c,d]=(0,o.useState)([]),[m,u]=(0,o.useState)(!1),[h,p]=(0,o.useState)(!1),{yjsDocMap:g}=t;(0,o.useEffect)((()=>{if(e){const t=e("comments",g);return s.registerCollaboration(t)}}),[s,e,g]);const f=(0,o.useCallback)((()=>{n.update((()=>{const e=(0,ae.vJ)();null!==e&&(e.dirty=!0)})),u(!1)}),[n]),C=(0,o.useCallback)(((e,t)=>{if("comment"===e.type){const n=s.deleteCommentOrThread(e,t);if(!n)return;const{markedComment:o,index:a}=n;s.addComment(o,t,a)}else{s.deleteCommentOrThread(e);const o=void 0!==t?t.id:e.id,a=i.get(o);void 0!==a&&setTimeout((()=>{n.update((()=>{for(const e of a){const t=(0,ae.ns)(e);(0,ne.I0)(t)&&(t.deleteID(o),0===t.getIDs().length&&(0,ne.PR)(t))}}))}))}}),[s,n,i]),j=(0,o.useCallback)(((e,t,o)=>{s.addComment(e,o),t&&(n.update((()=>{const t=(0,ae.vJ)();if((0,ae.I2)(t)){const n=t.focus,o=t.anchor,s=t.isBackward(),a=e.id;(0,ne.h)(t,s,a),s?n.set(o.key,o.offset,o.type):o.set(n.key,n.offset,n.type)}})),u(!1))}),[s,n]);return(0,o.useEffect)((()=>{const e=[];for(let t=0;t<c.length;t++){const o=c[t],s=i.get(o);if(void 0!==s)for(const t of s){const o=n.getElementByKey(t);null!==o&&(o.classList.add("selected"),e.push(o),p(!0))}}return()=>{for(let t=0;t<e.length;t++)e[t].classList.remove("selected")}}),[c,n,i]),(0,o.useEffect)((()=>{const e=new Map;return(0,re.Sd)((0,re.v6)(n,ne.y6,(e=>(0,ne.YM)(e.getIDs())),((e,t)=>{e.getIDs().forEach((e=>{t.addID(e)}))})),n.registerMutationListener(ne.y6,(t=>{n.getEditorState().read((()=>{for(const[n,o]of t){const t=(0,ae.ns)(n);let s=[];"destroyed"===o?s=e.get(n)||[]:(0,ne.I0)(t)&&(s=t.getIDs());for(let t=0;t<s.length;t++){const a=s[t];let r=i.get(a);e.set(n,s),"destroyed"===o?void 0!==r&&(r.delete(n),0===r.size&&i.delete(a)):(void 0===r&&(r=new Set,i.set(a,r)),r.has(n)||r.add(n))}}}))})),n.registerUpdateListener((({editorState:e,tags:t})=>{e.read((()=>{const e=(0,ae.vJ)();let t=!1,n=!1;if((0,ae.I2)(e)){const o=e.anchor.getNode();if((0,ae.kF)(o)){const s=(0,ne.yn)(o,e.anchor.offset);null!==s&&(d(s),t=!0),e.isCollapsed()||(l(o.getKey()),n=!0)}}t||d((e=>0===e.length?e:[])),n||l(null)})),t.has("collaboration")||u(!1)})),n.registerCommand(Oe,(()=>{const e=window.getSelection();return null!==e&&e.removeAllRanges(),u(!0),!0}),ae.jZ))}),[n,i]),(0,ce.jsxs)(ce.Fragment,{children:[m&&(0,se.createPortal)((0,ce.jsx)($e,{editor:n,cancelAddComment:f,submitAddComment:j}),document.body),null!=r&&!m&&(0,se.createPortal)((0,ce.jsx)(Me,{anchorKey:r,editor:n,onAddComment:()=>{n.dispatchCommand(Oe,void 0)}}),document.body),(0,se.createPortal)((0,ce.jsx)(Be.$,{className:"CommentPlugin_ShowCommentsButton "+(h?"active":""),onClick:()=>p(!h),title:h?"Hide Comments":"Show Comments",children:(0,ce.jsx)("i",{className:"comments"})}),document.body),h&&(0,se.createPortal)((0,ce.jsx)(Ve,{comments:a,submitAddComment:j,deleteCommentOrThread:C,activeIDs:c,markNodeMap:i}),document.body)]})}var Ye=n(9765);function Xe({editor:e,anchorElem:t,isLink:n,isBold:s,isItalic:a,isUnderline:i,isCode:r,isStrikethrough:l,isSubscript:c,isSuperscript:d}){const m=(0,o.useRef)(null),u=(0,o.useCallback)((()=>{n?e.dispatchCommand(A.yW,null):e.dispatchCommand(A.yW,"https://")}),[e,n]),h=(0,o.useCallback)((()=>{const n=(0,ae.vJ)(),o=m.current,s=window.getSelection();if(null===o)return;const a=e.getRootElement();if(null!==n&&null!==s&&!s.isCollapsed&&null!==a&&a.contains(s.anchorNode)){const e=function(e,t){const n=e.getRangeAt(0);let o;if(e.anchorNode===t){let e=t;for(;null!=e.firstElementChild;)e=e.firstElementChild;o=e.getBoundingClientRect()}else o=n.getBoundingClientRect();return o}(s,a);!function(e,t,n,o=10,s=5){const a=n.parentElement;if(null===e||!a)return t.style.opacity="0",t.style.top="-10000px",void(t.style.left="-10000px");const i=t.getBoundingClientRect(),r=n.getBoundingClientRect(),l=a.getBoundingClientRect();let c=e.top-i.height-o,d=e.left-s;c<l.top&&(c+=i.height+e.height+2*o),d+i.width>l.right&&(d=l.right-i.width-s),c-=r.top,d-=r.left,t.style.opacity="1",t.style.top=`${c}px`,t.style.left=`${d}px`}(e,o,t)}}),[e,t]);return(0,o.useEffect)((()=>{const n=t.parentElement,o=()=>{e.getEditorState().read((()=>{h()}))};return window.addEventListener("resize",o),n&&n.addEventListener("scroll",o),()=>{window.removeEventListener("resize",o),n&&n.removeEventListener("scroll",o)}}),[e,h,t]),(0,o.useEffect)((()=>(e.getEditorState().read((()=>{h()})),(0,re.Sd)(e.registerUpdateListener((({editorState:e})=>{e.read((()=>{h()}))})),e.registerCommand(ae.Mv,(()=>(h(),!1)),ae.Ac)))),[e,h]),(0,ce.jsxs)("div",{ref:m,className:"floating-text-format-popup",children:[e.isEditable()&&(0,ce.jsxs)(ce.Fragment,{children:[(0,ce.jsx)("button",{onClick:()=>{e.dispatchCommand(ae.mB,"bold")},className:"popup-item spaced "+(s?"active":""),"aria-label":"Format text as bold",children:(0,ce.jsx)("i",{className:"format bold"})}),(0,ce.jsx)("button",{onClick:()=>{e.dispatchCommand(ae.mB,"italic")},className:"popup-item spaced "+(a?"active":""),"aria-label":"Format text as italics",children:(0,ce.jsx)("i",{className:"format italic"})}),(0,ce.jsx)("button",{onClick:()=>{e.dispatchCommand(ae.mB,"underline")},className:"popup-item spaced "+(i?"active":""),"aria-label":"Format text to underlined",children:(0,ce.jsx)("i",{className:"format underline"})}),(0,ce.jsx)("button",{onClick:()=>{e.dispatchCommand(ae.mB,"strikethrough")},className:"popup-item spaced "+(l?"active":""),"aria-label":"Format text with a strikethrough",children:(0,ce.jsx)("i",{className:"format strikethrough"})}),(0,ce.jsx)("button",{onClick:()=>{e.dispatchCommand(ae.mB,"subscript")},className:"popup-item spaced "+(c?"active":""),title:"Subscript","aria-label":"Format Subscript",children:(0,ce.jsx)("i",{className:"format subscript"})}),(0,ce.jsx)("button",{onClick:()=>{e.dispatchCommand(ae.mB,"superscript")},className:"popup-item spaced "+(d?"active":""),title:"Superscript","aria-label":"Format Superscript",children:(0,ce.jsx)("i",{className:"format superscript"})}),(0,ce.jsx)("button",{onClick:()=>{e.dispatchCommand(ae.mB,"code")},className:"popup-item spaced "+(r?"active":""),"aria-label":"Insert code block",children:(0,ce.jsx)("i",{className:"format code"})}),(0,ce.jsx)("button",{onClick:u,className:"popup-item spaced "+(n?"active":""),"aria-label":"Insert link",children:(0,ce.jsx)("i",{className:"format link"})})]}),(0,ce.jsx)("button",{onClick:()=>{e.dispatchCommand(Oe,void 0)},className:"popup-item spaced","aria-label":"Insert comment",children:(0,ce.jsx)("i",{className:"format add-comment"})})]})}function et({anchorElem:e=document.body}){const[t]=(0,x.DF)();return function(e,t){const[n,s]=(0,o.useState)(!1),[a,i]=(0,o.useState)(!1),[r,l]=(0,o.useState)(!1),[c,d]=(0,o.useState)(!1),[m,u]=(0,o.useState)(!1),[h,p]=(0,o.useState)(!1),[g,x]=(0,o.useState)(!1),[f,C]=(0,o.useState)(!1),[j,_]=(0,o.useState)(!1),b=(0,o.useCallback)((()=>{e.getEditorState().read((()=>{if(e.isComposing())return;const t=(0,ae.vJ)(),n=window.getSelection(),o=e.getRootElement();if(!(null===n||(0,ae.I2)(t)&&null!==o&&o.contains(n.anchorNode)))return void s(!1);if(!(0,ae.I2)(t))return;const a=function(e){const t=e.anchor,n=e.focus,o=e.anchor.getNode(),s=e.focus.getNode();return o===s?o:e.isBackward()?(0,ie.Nx)(n)?o:s:(0,ie.Nx)(t)?s:o}(t);l(t.hasFormat("bold")),d(t.hasFormat("italic")),u(t.hasFormat("underline")),p(t.hasFormat("strikethrough")),x(t.hasFormat("subscript")),C(t.hasFormat("superscript")),_(t.hasFormat("code"));const r=a.getParent();(0,A.FJ)(r)||(0,A.FJ)(a)?i(!0):i(!1),(0,Ye.yN)(t.anchor.getNode())||""===t.getTextContent()?s(!1):s((0,ae.kF)(a))}))}),[e]);return(0,o.useEffect)((()=>(document.addEventListener("selectionchange",b),()=>{document.removeEventListener("selectionchange",b)})),[b]),(0,o.useEffect)((()=>(0,re.Sd)(e.registerUpdateListener((()=>{b()})),e.registerRootListener((()=>{null===e.getRootElement()&&s(!1)})))),[e,b]),!n||a?null:(0,se.createPortal)((0,ce.jsx)(Xe,{editor:e,anchorElem:t,isLink:a,isBold:r,isItalic:c,isStrikethrough:h,isSubscript:g,isSuperscript:f,isUnderline:m,isCode:j}),t)}(t,e)}function tt(){return(0,ce.jsx)("div",{className:"editor-placeholder",children:"Welcome to the Datalayer literate editor to code and analyse data."})}const nt={namespace:"Jupyter React Lexical example",theme:oe,onError(e){throw e},nodes:[w.jL,I.v5,I.YW,w.dJ,B._F,D.ZD,F.LX,L.HA,L.B9,L.py,A.k_,A.Db,R.NH,O.HS,M.K1,H.K$,T.fS,N.ZZ,ne.y6]},ot=()=>{const{setEditor:e}=(0,g.SF)(),[t]=(0,x.DF)();return(0,o.useEffect)((()=>(e(t),()=>e(void 0))),[t]),null},st=e=>{const{notebook:t}=e,[n,s]=(0,o.useState)(null);return(0,ce.jsx)(f.n,{initialConfig:nt,children:(0,ce.jsx)("div",{className:"editor-shell",children:(0,ce.jsxs)("div",{className:"editor-container",children:[(0,ce.jsx)(Ce,{}),(0,ce.jsxs)("div",{className:"editor-inner",children:[(0,ce.jsx)(C.$,{contentEditable:(0,ce.jsx)("div",{className:"editor-scroller",children:(0,ce.jsx)("div",{className:"editor",ref:e=>{null!==e&&s(e)},children:(0,ce.jsx)(j.a,{})})}),placeholder:(0,ce.jsx)(tt,{}),ErrorBoundary:S.A}),(0,ce.jsx)(k.D,{onChange:function(e){}}),(0,ce.jsx)(_.G,{}),(0,ce.jsx)(b.x,{}),(0,ce.jsx)(y.A,{}),(0,ce.jsx)(E.Q,{}),(0,ce.jsx)(P.A,{}),(0,ce.jsx)(v.W,{}),(0,ce.jsx)(J.p,{}),(0,ce.jsx)(z.i,{maxDepth:7}),(0,ce.jsx)(U.L,{}),(0,ce.jsx)($.FE,{}),(0,ce.jsx)(Z.hM,{}),(0,ce.jsx)(q.u,{}),(0,ce.jsx)(K.fo,{}),(0,ce.jsx)(W.GO,{}),(0,ce.jsx)(V.C,{}),(0,ce.jsx)(Q.LX,{}),(0,ce.jsx)(G.K,{notebook:t}),(0,ce.jsx)(Y.EZ,{}),(0,ce.jsx)(ot,{}),(0,ce.jsx)(X.H,{}),(0,ce.jsx)(Ge,{providerFactory:void 0}),n&&(0,ce.jsxs)(ce.Fragment,{children:[(0,ce.jsx)(ee.q,{anchorElem:n}),(0,ce.jsx)(te.U,{anchorElem:n}),(0,ce.jsx)(et,{anchorElem:n})]})]})]})})})};var at=n(17810),it=n(53850),rt=n(97734),lt=n(23530),ct=n(27199),dt=n(41046);const mt=()=>(0,ce.jsx)(l.A,{display:"flex",children:(0,ce.jsx)(l.A,{children:(0,ce.jsx)(c.Q,{variant:"invisible",size:"small",leadingVisual:p.iKr,onClick:()=>dt.xK.getState().save(new Date),children:"Save"})})}),ut=()=>{const{documentId:e}=(0,s.g)();if(!e)return(0,ce.jsx)(ce.Fragment,{});const t=(0,at.J)(),{hideBackdrop:n,setItem:x,showBackdrop:f,space:C,triggerItemsRefresh:j}=(0,ct.l5)(),{documentSaveRequest:_}=(0,dt.q3)(),{editor:b}=(0,g.SF)(),{cloneDocument:y,getDocument:v,refreshDocument:E,updateDocument:N,updateDocumentModel:k}=(0,it.E)(),{enqueueToast:P}=(0,rt.d)(),T=(0,a.S)(),S=(0,lt.Z)(),[w,L]=(0,o.useState)("none"),[I,A]=(0,o.useState)(),[B,D]=(0,o.useState)({name:"",description:""}),[F,R]=(0,o.useState)({name:void 0,description:void 0});(0,o.useEffect)((()=>{if(b&&I&&I.model){const e=b.parseEditorState(I.model);b.setEditorState(e),b.focus((()=>{}),{defaultSelection:"rootStart"})}}),[e,I,b]),(0,o.useEffect)((()=>("properties"!==w&&(f(),E(e).then((t=>{if(t.success){const t=v(e);t?(A(t),x(t),D({name:t.name,description:t.description})):S("/")}})).finally((()=>{n()}))),()=>{A(void 0),x(void 0)})),[e]),(0,o.useEffect)((()=>{_&&I&&b&&I&&(A({...I,model:b.getEditorState().toJSON()}),f("Saving the document..."),k(e,b.getEditorState().toJSON()).then((e=>{e.success&&P("The document is successfully updated.",{variant:"success"})})).finally((()=>{n()})))}),[_]),(0,o.useEffect)((()=>{R({...F,name:void 0===B.name?void 0:B.name.length>2,description:void 0===B.description?void 0:B.description.length>2})}),[B]);const O=(0,o.useCallback)((async o=>{T({title:"Are you sure?",content:"Please confirm you want to clone this document in your private library."}).then((o=>{o&&(f(),y(e).then((e=>{n(),e.success&&(P(e.message,{variant:"success"}),j(),S(`/${t.handle}/library/documents`))})).finally((()=>{n()})))}))}),[T,I]);return(0,ce.jsxs)(ce.Fragment,{children:[(0,ce.jsxs)(i.z,{role:"header","aria-label":"Document Editor",children:[(0,ce.jsxs)(i.z.TitleArea,{variant:"subtitle",children:[(0,ce.jsx)(i.z.Title,{children:"Document Editor"}),(0,ce.jsx)(i.z.TrailingVisual,{children:(0,ce.jsx)(r.A,{children:"Rich"})})]}),(0,ce.jsxs)(i.z.Actions,{children:[I&&(0,ce.jsx)(l.A,{children:(0,ce.jsx)(mt,{})}),I&&C&&(0,ce.jsx)(l.A,{ml:3,children:(0,ce.jsx)(c.Q,{variant:"invisible",size:"small",leadingVisual:p.Nc$,onClick:O,children:"Clone"})}),(0,ce.jsx)(c.Q,{variant:"invisible",size:"small",leadingVisual:p.L64,onClick:e=>{L("properties"===w?"none":"properties")},children:"Properties"},"properties")]})]}),(0,ce.jsxs)(d.O7,{children:[I&&"properties"===w&&(0,ce.jsx)(d.O7.Pane,{"aria-label":"Document Properties",position:"start",children:(0,ce.jsx)(ce.Fragment,{children:(0,ce.jsx)(l.A,{display:"grid",gridTemplateColumns:"1fr 1fr",children:(0,ce.jsx)(l.A,{children:(0,ce.jsxs)(l.A,{sx:{label:{marginTop:2}},children:[(0,ce.jsxs)(m.A,{children:[(0,ce.jsx)(m.A.Label,{children:"Name"}),(0,ce.jsx)(u.A,{block:!0,value:B.name,onChange:e=>{D((t=>({...t,name:e.target.value})))}}),!1===F.name&&(0,ce.jsx)(m.A.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,ce.jsxs)(m.A,{children:[(0,ce.jsx)(m.A.Label,{children:"Description"}),(0,ce.jsx)(h.Ay,{block:!0,value:B.description,onChange:e=>{D((t=>({...t,description:e.target.value})))}}),!1===F.description&&(0,ce.jsx)(m.A.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,ce.jsx)(m.A,{children:(0,ce.jsx)(c.Q,{variant:"primary",disabled:!F.name||!F.description,sx:{marginTop:2},onClick:async()=>{f(),N(e,B.name,B.description).then((e=>{e.success&&(P("The document is successfully updated.",{variant:"success"}),j(),A({...I,name:B.name,description:B.description}))})).finally((()=>{n()}))},children:"Update document"})})]})})})})}),(0,ce.jsx)(d.O7.Content,{"aria-label":"Document Editor",width:"full",padding:"none",children:I&&I.model&&(0,ce.jsx)(l.A,{children:(0,ce.jsx)(st,{})})})]})]})},ht=ut},22426:e=>{e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjIuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCAxOCAxOCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMTggMTg7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDpub25lO30KPC9zdHlsZT4KPHBhdGggZD0iTTUuMiw1LjlMOSw5LjdsMy44LTMuOGwxLjIsMS4ybC00LjksNWwtNC45LTVMNS4yLDUuOXoiLz4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTAtMC42aDE4djE4SDBWLTAuNnoiLz4KPC9zdmc+Cg"}}]);