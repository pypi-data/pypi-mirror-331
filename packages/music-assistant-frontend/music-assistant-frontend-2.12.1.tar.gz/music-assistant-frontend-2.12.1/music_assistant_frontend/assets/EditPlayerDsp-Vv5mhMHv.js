import{g as me,p as fe,ca as Ue,j as ke,t as B,m as Ne,k as We,A as ce,B as l,an as L,F as Ge,K as Te,cb as Pe,J as $e,N as pe,c5 as Fe,ad as Qe,s as je,x as H,w as W,a as ne,I as qe,ae as Ke,h as Xe,ai as Ye,f as Je,z as Ze,c as j,H as el,al as ll,cc as tl,Q as te,ah as Ae,R as S,S as V,U as a,Z as le,as as Z,bD as G,ao as C,ab as F,G as se,$ as De,az as al,a3 as nl,bv as sl,bw as ve,a8 as x,a7 as Q,W as J,cd as b,o as Ce,a9 as D,ce as re,a0 as $,bn as il,bp as ie,aX as ol,cf as N,l as rl,b5 as ul,a4 as oe,b1 as dl,bx as ml,bE as fl}from"./index-CW9q7Ug9.js";import{a as O}from"./VBtn-BG_l-jMN.js";import{_ as Ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as cl}from"./VSlider-CDrQMla_.js";import{V as pl}from"./VTextField-Dh0rJNQB.js";import{V as Oe}from"./VContainer-DzQ369Qf.js";import{V as we,a as ue}from"./VRow-DLxHB18w.js";import{V as de,a as Ee}from"./VSwitch-G4hrPlq3.js";import{V as xe}from"./VSpacer-Cfs--T9C.js";import{V as he,a as Se}from"./VToolbar-C3R4TUTJ.js";import{V as vl}from"./VDialog-hpeVNzwd.js";import{V as gl}from"./VAlert-QmZazhWy.js";import{V as yl}from"./VCheckbox-iOyX9dtq.js";import"./VCheckboxBtn-VcTG8xE4.js";/* empty css              */import"./VVirtualScroll-BDWbQaCz.js";const bl=fe({dotColor:String,fillDot:Boolean,hideDot:Boolean,icon:Fe,iconColor:String,lineColor:String,...pe(),...$e(),...Pe(),...Te()},"VTimelineDivider"),_l=me()({name:"VTimelineDivider",props:bl(),setup(t,_){let{slots:m}=_;const{sizeClasses:o,sizeStyles:i}=Ue(t,"v-timeline-divider__dot"),{backgroundColorStyles:h,backgroundColorClasses:T}=ke(B(t,"dotColor")),{roundedClasses:f}=Ne(t,"v-timeline-divider__dot"),{elevationClasses:k}=We(t),{backgroundColorClasses:c,backgroundColorStyles:q}=ke(B(t,"lineColor"));return ce(()=>l("div",{class:["v-timeline-divider",{"v-timeline-divider--fill-dot":t.fillDot},t.class],style:t.style},[l("div",{class:["v-timeline-divider__before",c.value],style:q.value},null),!t.hideDot&&l("div",{key:"dot",class:["v-timeline-divider__dot",k.value,f.value,o.value],style:i.value},[l("div",{class:["v-timeline-divider__inner-dot",T.value,f.value],style:h.value},[m.default?l(Ge,{key:"icon-defaults",disabled:!t.icon,defaults:{VIcon:{color:t.iconColor,icon:t.icon,size:t.size}}},m.default):l(L,{key:"icon",color:t.iconColor,icon:t.icon,size:t.size},null)])]),l("div",{class:["v-timeline-divider__after",c.value],style:q.value},null)])),{}}}),He=fe({density:String,dotColor:String,fillDot:Boolean,hideDot:Boolean,hideOpposite:{type:Boolean,default:void 0},icon:Fe,iconColor:String,lineInset:[Number,String],...pe(),...Ke(),...Te(),...$e(),...Pe(),...qe()},"VTimelineItem"),Y=me()({name:"VTimelineItem",props:He(),setup(t,_){let{slots:m}=_;const{dimensionStyles:o}=Qe(t),i=je(0),h=H();return W(h,T=>{var f;T&&(i.value=((f=T.$el.querySelector(".v-timeline-divider__dot"))==null?void 0:f.getBoundingClientRect().width)??0)},{flush:"post"}),ce(()=>{var T,f;return l("div",{class:["v-timeline-item",{"v-timeline-item--fill-dot":t.fillDot},t.class],style:[{"--v-timeline-dot-size":ne(i.value),"--v-timeline-line-inset":t.lineInset?`calc(var(--v-timeline-dot-size) / 2 + ${ne(t.lineInset)})`:ne(0)},t.style]},[l("div",{class:"v-timeline-item__body",style:o.value},[(T=m.default)==null?void 0:T.call(m)]),l(_l,{ref:h,hideDot:t.hideDot,icon:t.icon,iconColor:t.iconColor,size:t.size,elevation:t.elevation,dotColor:t.dotColor,fillDot:t.fillDot,rounded:t.rounded},{default:m.icon}),t.density!=="compact"&&l("div",{class:"v-timeline-item__opposite"},[!t.hideOpposite&&((f=m.opposite)==null?void 0:f.call(m))])])}),{}}}),Vl=fe({align:{type:String,default:"center",validator:t=>["center","start"].includes(t)},direction:{type:String,default:"vertical",validator:t=>["vertical","horizontal"].includes(t)},justify:{type:String,default:"auto",validator:t=>["auto","center"].includes(t)},side:{type:String,validator:t=>t==null||["start","end"].includes(t)},lineThickness:{type:[String,Number],default:2},lineColor:String,truncateLine:{type:String,validator:t=>["start","end","both"].includes(t)},...tl(He({lineInset:0}),["dotColor","fillDot","hideOpposite","iconColor","lineInset","size"]),...pe(),...ll(),...qe(),...el()},"VTimeline"),kl=me()({name:"VTimeline",props:Vl(),setup(t,_){let{slots:m}=_;const{themeClasses:o}=Xe(t),{densityClasses:i}=Ye(t),{rtlClasses:h}=Je();Ze({VTimelineDivider:{lineColor:B(t,"lineColor")},VTimelineItem:{density:B(t,"density"),dotColor:B(t,"dotColor"),fillDot:B(t,"fillDot"),hideOpposite:B(t,"hideOpposite"),iconColor:B(t,"iconColor"),lineColor:B(t,"lineColor"),lineInset:B(t,"lineInset"),size:B(t,"size")}});const T=j(()=>{const k=t.side?t.side:t.density!=="default"?"end":null;return k&&`v-timeline--side-${k}`}),f=j(()=>{const k=["v-timeline--truncate-line-start","v-timeline--truncate-line-end"];switch(t.truncateLine){case"both":return k;case"start":return k[0];case"end":return k[1];default:return null}});return ce(()=>l(t.tag,{class:["v-timeline",`v-timeline--${t.direction}`,`v-timeline--align-${t.align}`,`v-timeline--justify-${t.justify}`,f.value,{"v-timeline--inset-line":!!t.lineInset},o.value,i.value,T.value,h.value,t.class],style:[{"--v-timeline-line-thickness":ne(t.lineThickness)},t.style]},m)),{}}}),Cl=te({__name:"DSPPipeline",props:{dsp:{},selected:{}},emits:["onSelect","onAddFilter","onMoveFilter","onDeleteFilter"],setup(t,{emit:_}){const m=Ae(),o=t,i=_,h=v=>o.selected===v?"primary":"secondary",T=v=>v==="input"||v==="output"?!1:!o.dsp.filters[v].enabled,f=v=>o.selected===v?"primary":m.global.current.value.dark?"grey-darken-3":"grey-lighten-3",k=v=>({"filter-selected":o.selected===v}),c=v=>{i("onSelect",v)},q=(v,p)=>{i("onMoveFilter",{index:v,direction:p})},z=v=>{i("onDeleteFilter",v)},K=function(v,p){const P=[{label:"settings.dsp.move_up",labelArgs:[],action:()=>{q(p,"up")},disabled:p===0,icon:"mdi-arrow-up"},{label:"settings.dsp.move_down",labelArgs:[],action:()=>{q(p,"down")},disabled:p===o.dsp.filters.length-1,icon:"mdi-arrow-down"},{label:"settings.dsp.delete_filter",labelArgs:[],action:()=>{z(p)},icon:"mdi-delete"}];nl.emit("contextmenu",{items:P,posX:v.clientX,posY:v.clientY})};return(v,p)=>(V(),S(kl,{density:"compact",side:"end"},{default:a(()=>[l(Y,{"dot-color":h("input"),size:"x-small",onClick:p[0]||(p[0]=P=>c("input"))},{default:a(()=>[l(O,{flat:"",rounded:"pill",color:f("input"),class:Z([k("input"),"dsp-pipeline-card"])},{default:a(()=>[l(G,{class:"px-3 py-1"},{default:a(()=>[C(F(v.$t("settings.dsp.input")),1)]),_:1})]),_:1},8,["color","class"])]),_:1},8,["dot-color"]),l(Y,{"hide-dot":!0,size:"x-small"}),(V(!0),le(se,null,De(v.dsp.filters,(P,w)=>(V(),S(Y,{key:w,"dot-color":h(w),size:"x-small","hide-dot":T(w),onClick:u=>c(w),onContextmenu:al(u=>K(u,w),["prevent"])},{default:a(()=>[l(O,{flat:"",rounded:"pill",color:f(w),class:Z([k(w),"dsp-pipeline-card"])},{default:a(()=>[l(G,{class:"px-3 py-1"},{default:a(()=>[C(F(v.$t(`settings.dsp.types.${P.type}`)),1)]),_:2},1024)]),_:2},1032,["color","class"])]),_:2},1032,["dot-color","hide-dot","onClick","onContextmenu"]))),128)),l(Y,{"dot-color":"secondary",size:"x-small","hide-dot":!0},{default:a(()=>[l(O,{outlined:"",rounded:"pill",class:"dsp-pipeline-card add-filter-btn",elevation:0,onClick:p[1]||(p[1]=P=>i("onAddFilter"))},{default:a(()=>[l(G,{class:"py-1 d-flex align-center"},{default:a(()=>[l(L,{size:"small",class:"mr-1"},{default:a(()=>p[3]||(p[3]=[C("mdi-plus")])),_:1}),C(" "+F(v.$t("settings.dsp.filter.add")),1)]),_:1})]),_:1})]),_:1}),l(Y,{"hide-dot":!0,size:"x-small"}),l(Y,{"dot-color":h("output"),size:"x-small",onClick:p[2]||(p[2]=P=>c("output"))},{default:a(()=>[l(O,{flat:"",rounded:"pill",color:f("output"),class:Z([k("output"),"dsp-pipeline-card"])},{default:a(()=>[l(G,{class:"px-3 py-1"},{default:a(()=>[C(F(v.$t("settings.dsp.output")),1)]),_:1})]),_:1},8,["color","class"])]),_:1},8,["dot-color"])]),_:1}))}}),hl=Ie(Cl,[["__scopeId","data-v-f292f100"]]),Sl={style:{"min-width":"100px"},class:"v-label pl-2"},Tl={style:{"min-width":"40px"},class:"pl-2"},U=te({__name:"DSPSlider",props:sl({type:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const _=t,m=ve(t,"modelValue"),o=H(!1),i=j(()=>_.type==="gain"?{min:-15,max:15,step:.1,label:x("settings.dsp.parameter.gain"),unit:"dB"}:_.type==="q"?{min:.1,max:20,step:.1,label:x("settings.dsp.parameter.q_factor"),unit:""}:_.type==="frequency"?{min:20,max:2e4,step:1,label:x("settings.dsp.parameter.frequency"),unit:"Hz"}:_.type),h=j({get:()=>o.value?m.value.toString():m.value>1e3?m.value.toFixed(0):m.value>100?m.value.toFixed(1):m.value.toFixed(2),set:T=>{m.value=Number(T)}});return(T,f)=>(V(),S(Q,{flat:"",color:"transparent"},{default:a(()=>[l(G,{class:"d-flex align-center gap-4"},{default:a(()=>[J("span",Sl,F(i.value.label),1),l(cl,{modelValue:m.value,"onUpdate:modelValue":f[0]||(f[0]=k=>m.value=k),min:i.value.min,max:i.value.max,step:i.value.step,"hide-details":"",class:"flex-grow-1 pr-4",density:"compact",color:"primary"},null,8,["modelValue","min","max","step"]),l(pl,{modelValue:h.value,"onUpdate:modelValue":f[1]||(f[1]=k=>h.value=k),type:"number","hide-details":"",density:"compact",style:{"max-width":"100px"},onFocus:f[2]||(f[2]=k=>o.value=!0),onBlur:f[3]||(f[3]=k=>o.value=!1)},null,8,["modelValue"]),J("span",Tl,F(i.value.unit),1)]),_:1})]),_:1}))}}),Pl={class:"d-flex align-center"},$l=te({__name:"DSPParametricEQ",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(t){const _={PK:b.PEAK,PEQ:b.PEAK,HP:b.HIGH_PASS,HPQ:b.HIGH_PASS,LP:b.LOW_PASS,LPQ:b.LOW_PASS,LS:b.LOW_SHELF,HS:b.HIGH_SHELF,NO:b.NOTCH},m={[b.PEAK]:"PK",[b.HIGH_PASS]:"HP",[b.LOW_PASS]:"LP",[b.LOW_SHELF]:"LS",[b.HIGH_SHELF]:"HS",[b.NOTCH]:"NO"},o=s=>{const e=s.split(`
`),r=[];c.value.preamp=0;for(const g of e)if(g.startsWith("Filter")){const y=g.match(/Filter(?:\s+\d+)?:\s+(ON|OFF)\s+(\w+)\s+(?:Fc\s+)?(\d+\.?\d*)\s*(?:Hz)?\s+(?:Gain\s+)?(-?\d+\.?\d*)\s+dB\s+(?:(?:Q\s+)?(\d+\.?\d*)|(?:BW\s+Oct\s+)(\d+\.?\d*))/);if(y){const[I,M,X,A,R,ye,be]=y;X!=="None"&&r.push({frequency:parseFloat(A),gain:parseFloat(R),q:parseFloat(ye),type:_[X]||b.PEAK,enabled:M==="ON"})}}else if(g.startsWith("Preamp")){const y=g.match(/Preamp:\s*(-?\d+\.?\d*)\s+dB/);y&&(c.value.preamp=parseFloat(y[1]))}c.value.bands=r,n.value=-1},i=s=>{const e=s.target;if(e.files&&e.files[0]){const r=e.files[0],g=new FileReader;g.onload=y=>{var I;(I=y.target)!=null&&I.result&&o(y.target.result)},g.readAsText(r)}},h=H(null),T=()=>{var s;(s=h.value)==null||s.click()},f=()=>{let s=`Preamp: ${ee.value.toFixed(2)} dB
`;c.value.bands.forEach((y,I)=>{const M=m[y.type];s+=`Filter ${I+1}: ${y.enabled?"ON":"OFF"} ${M} Fc ${y.frequency.toFixed(1)} Hz Gain ${y.gain.toFixed(2)} dB Q ${y.q.toFixed(3)}
`});const e=new Blob([s],{type:"text/plain"}),r=URL.createObjectURL(e),g=document.createElement("a");g.href=r,g.download=`music_assistant_eq_settings_${new Date().toISOString().split("T")[0]}.txt`,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(r)},k=Ae(),c=ve(t,"modelValue"),q=H(null),z=H(null),K=Object.values(b).map(s=>({title:x(`settings.dsp.parametric_eq.filter_types.${s}`),value:s})),v=s=>![b.HIGH_PASS,b.LOW_PASS,b.NOTCH].includes(s),p=H({width:0,height:0,min_gain:-20,max_gain:20,min_freq:20,max_freq:2e4,padding_lr:40,padding_tb:20}),P=()=>{if(!q.value||!z.value)return;const s=k.global.current.value.dark,e=q.value.getContext("2d");if(!e)return;q.value.width=z.value.clientWidth*2,q.value.height=z.value.clientHeight*2,p.value.width=q.value.width/2,p.value.height=q.value.height/2,e.scale(2,2),e.clearRect(0,0,q.value.width,q.value.height),Le(e,p.value);const r=e.canvas.width/2;e.canvas.height/2;const g=new Float32Array(r).fill(c.value.preamp??0);c.value.bands.forEach((y,I)=>{if(y.enabled){let M=`hsla(${I*360/c.value.bands.length}, 60%, ${s?70:50}%, 0.5)`;e.beginPath(),I===n.value?(e.lineWidth=5,M=`hsla(${I*360/c.value.bands.length}, 70%, ${s?70:60}%, 1)`):e.lineWidth=2,e.strokeStyle=M;const X=new Float32Array(r);for(let E=0;E<r;E++)X[E]=ze(E,p.value);const A=new Float32Array(r),R=new Float32Array(r);w(u,y).getFrequencyResponse(X,A,R);for(let E=p.value.padding_lr;E<r-p.value.padding_lr;E++){const _e=20*Math.log10(A[E]);g[E]+=_e;const Ve=ae(_e,p.value);E===0?e.moveTo(E,Ve):e.lineTo(E,Ve)}e.stroke();const be=ge(y.frequency,p.value),Me=ae(y.gain,p.value);e.beginPath(),e.fillStyle=M,e.arc(be,Me,6,0,2*Math.PI),e.fill()}}),e.lineWidth=2,s?e.strokeStyle="#fff":e.strokeStyle="#000",e.beginPath();for(let y=p.value.padding_lr;y<r-p.value.padding_lr;y++){const I=ae(g[y],p.value);y===0?e.moveTo(y,I):e.lineTo(y,I)}e.stroke()},w=(s,e)=>{const r=s.createBiquadFilter();switch(e.type){case b.HIGH_PASS:r.type="highpass";break;case b.LOW_PASS:r.type="lowpass";break;case b.HIGH_SHELF:r.type="highshelf";break;case b.LOW_SHELF:r.type="lowshelf";break;case b.NOTCH:r.type="notch";break;case b.PEAK:r.type="peaking";break}return r.frequency.value=e.frequency,r.Q.value=e.q,r.gain.value=e.gain,r},u=new AudioContext;j(()=>c.value.bands.map(s=>w(u,s)));const n=H(-1),d=j(()=>c.value.bands[n.value]),ee=j({get:()=>c.value.preamp??0,set:s=>{c.value.preamp=s}}),Re=s=>{c.value.bands.splice(s,1),n.value>=c.value.bands.length&&(n.value=c.value.bands.length-1)},Be=()=>{const s=c.value.bands.length;c.value.bands.push({frequency:1e3,q:1,gain:0,type:b.PEAK,enabled:!0}),n.value=s};W(()=>c.value.bands,P,{deep:!0}),W(()=>c.value.preamp,P),W(()=>n.value,P),W(()=>k.global.current.value.dark,P),Ce(()=>{P(),window.addEventListener("resize",P)});const ge=(s,e)=>{const r=Math.log2(s/e.min_freq),g=Math.log2(e.max_freq/e.min_freq);return r/g*(e.width-e.padding_lr*2)+e.padding_lr},ze=(s,e)=>{const r=Math.log2(e.max_freq/e.min_freq),g=e.min_freq*Math.pow(2,(s-e.padding_lr)/(e.width-e.padding_lr*2)*r);return Math.min(Math.max(g,e.min_freq),e.max_freq)},ae=(s,e)=>e.height/2-s*(e.height-2*e.padding_tb)/(2*Math.max(Math.abs(e.min_gain),Math.abs(e.max_gain))),Le=(s,e)=>{const r=s.canvas.width/2,g=s.canvas.height/2;k.global.current.value.dark?(s.fillStyle="#eee",s.strokeStyle="#eee"):(s.fillStyle="#222",s.strokeStyle="#666"),s.lineWidth=1,[20,50,100,200,500,1e3,2e3,5e3,1e4,2e4].forEach(A=>{const R=ge(A,e);s.beginPath(),s.moveTo(R,e.padding_tb),s.lineTo(R,g-e.padding_tb),s.stroke(),s.font="10px Arial",s.textAlign="center",s.fillText(A>=1e3?`${A/1e3}k`:A.toString(),R,g-5)});const M=e.max_gain-e.min_gain,X=Math.ceil(M/(e.height/30));for(let A=e.min_gain;A<=e.max_gain;A+=X){const R=ae(A,e);s.beginPath(),s.moveTo(e.padding_lr,R),s.lineTo(r-e.padding_lr,R),s.stroke(),s.font="10px Arial",s.textAlign="right",s.fillText(`${A}dB`,e.padding_lr-3,R+3)}};return Ce(()=>{const s=new ResizeObserver(()=>{P()});return z.value&&s.observe(z.value),()=>{s.disconnect()}}),(s,e)=>(V(),S(Oe,{class:"pa-2"},{default:a(()=>[l(re,{class:"d-flex justify-end"},{default:a(()=>[l(O,{variant:"outlined",class:"mr-2",onClick:T},{default:a(()=>[l(L,{start:""},{default:a(()=>e[8]||(e[8]=[C("mdi-file-import")])),_:1}),C(" "+F($(x)("settings.dsp.parametric_eq.import_apo")),1)]),_:1}),l(O,{variant:"outlined",class:"mr-2",onClick:f},{default:a(()=>[l(L,{start:""},{default:a(()=>e[9]||(e[9]=[C("mdi-file-export")])),_:1}),C(" "+F($(x)("settings.dsp.parametric_eq.export_apo")),1)]),_:1}),J("input",{ref_key:"fileInputRef",ref:h,type:"file",accept:".txt",class:"d-none",onChange:i},null,544)]),_:1}),l(Q,{elevation:"0",color:"transparent"},{default:a(()=>[J("div",{ref_key:"graphContainer",ref:z,class:"graph-container"},[J("canvas",{ref_key:"canvas",ref:q,class:"frequency-graph"},null,512)],512)]),_:1}),l(Q,{elevation:"0",color:"transparent",class:"border-t border-b rounded-0"},{default:a(()=>[l(G,{class:"pa-0"},{default:a(()=>[l(il,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=r=>n.value=r),class:"mb-0 pa-2",mandatory:"","selected-class":"primary"},{default:a(()=>[(V(),S(ie,{key:-1,value:-1,filter:"",variant:"elevated"},{default:a(()=>[C(F($(x)("settings.dsp.parametric_eq.preamp",{index:100})),1)]),_:1})),(V(!0),le(se,null,De(c.value.bands,(r,g)=>(V(),S(ie,{key:g,value:g,class:Z({"opacity-50":!r.enabled}),filter:"",variant:"elevated"},{default:a(()=>[C(F($(x)("settings.dsp.parametric_eq.band",{index:g+1})),1)]),_:2},1032,["value","class"]))),128)),l(ie,{variant:"outlined",onClick:Be},{default:a(()=>[l(L,{icon:"mdi-plus",start:""}),C(" "+F($(x)("settings.dsp.parametric_eq.add_band")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),n.value===-1?(V(),S(Q,{key:0,elevation:"0",color:"transparent"},{default:a(()=>[l(G,null,{default:a(()=>[l(we,{dense:""},{default:a(()=>[l(ue,{cols:"12"},{default:a(()=>[l(U,{modelValue:ee.value,"onUpdate:modelValue":e[1]||(e[1]=r=>ee.value=r),type:"gain"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})):D("",!0),d.value?(V(),le(se,{key:1},[l(re,null,{default:a(()=>[J("div",Pl,[l(de,{modelValue:d.value.enabled,"onUpdate:modelValue":e[2]||(e[2]=r=>d.value.enabled=r),label:$(x)("settings.dsp.parametric_eq.enable_band"),density:"comfortable","hide-details":"",color:"primary"},null,8,["modelValue","label"]),l(xe),l(O,{color:"error",variant:"tonal",onClick:e[3]||(e[3]=r=>Re(n.value))},{default:a(()=>[l(L,null,{default:a(()=>e[10]||(e[10]=[C("mdi-delete")])),_:1}),C(" "+F($(x)("settings.dsp.parametric_eq.delete_band")),1)]),_:1})])]),_:1}),l(Ee,{modelValue:d.value.type,"onUpdate:modelValue":e[4]||(e[4]=r=>d.value.type=r),items:$(K),label:$(x)("settings.dsp.parametric_eq.filter_type"),variant:"outlined",density:"comfortable",class:"pa-4","hide-details":""},null,8,["modelValue","items","label"]),l(U,{modelValue:d.value.frequency,"onUpdate:modelValue":e[5]||(e[5]=r=>d.value.frequency=r),type:"frequency"},null,8,["modelValue"]),v(d.value.type)?(V(),S(U,{key:0,modelValue:d.value.gain,"onUpdate:modelValue":e[6]||(e[6]=r=>d.value.gain=r),type:"gain"},null,8,["modelValue"])):D("",!0),l(U,{modelValue:d.value.q,"onUpdate:modelValue":e[7]||(e[7]=r=>d.value.q=r),type:"q"},null,8,["modelValue"])],64)):D("",!0)]),_:1}))}}),Fl=Ie($l,[["__scopeId","data-v-8a55098e"]]),ql=te({__name:"DSPToneControl",props:{modelValue:{required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(t){const _=ve(t,"modelValue");return(m,o)=>(V(),le(se,null,[l(U,{modelValue:_.value.bass_level,"onUpdate:modelValue":o[0]||(o[0]=i=>_.value.bass_level=i),type:{min:-10,max:10,step:.1,label:m.$t("settings.dsp.tone_control.bass_level"),unit:"dB"}},null,8,["modelValue","type"]),l(U,{modelValue:_.value.mid_level,"onUpdate:modelValue":o[1]||(o[1]=i=>_.value.mid_level=i),type:{min:-10,max:10,step:.1,label:m.$t("settings.dsp.tone_control.mid_level"),unit:"dB"}},null,8,["modelValue","type"]),l(U,{modelValue:_.value.treble_level,"onUpdate:modelValue":o[2]||(o[2]=i=>_.value.treble_level=i),type:{min:-10,max:10,step:.1,label:m.$t("settings.dsp.tone_control.treble_level"),unit:"dB"}},null,8,["modelValue","type"])],64))}}),Al={key:0},Ql=te({__name:"EditPlayerDsp",props:{playerId:{}},setup(t){const{t:_}=ol();fl();const m=t,o=H(),i=H(null),h=H(!1),T=H(N.PARAMETRIC_EQ);H(window.innerWidth);const{mobile:f}=rl(),k=Object.values(N).map(u=>({value:u,title:_(`settings.dsp.types.${u}`)})),c=u=>{i.value=u},q=u=>{var n;return _(u==="input"?"settings.dsp.input":u==="output"?"settings.dsp.output":`settings.dsp.types.${(n=o.value)==null?void 0:n.filters[u].type}`)},z=()=>{if(!o.value)return;let u;switch(T.value){case N.PARAMETRIC_EQ:u={preamp:0,enabled:!0,type:N.PARAMETRIC_EQ,bands:[]};break;case N.TONE_CONTROL:u={enabled:!0,type:N.TONE_CONTROL,bass_level:0,mid_level:0,treble_level:0};break;default:return}o.value.filters.push(u),h.value=!1,c(o.value.filters.length-1)},K=(u,n)=>{if(!o.value)return;const d=n==="up"?u-1:u+1;if(d<0||d>=o.value.filters.length)return;const[ee]=o.value.filters.splice(u,1);o.value.filters.splice(d,0,ee),i.value===u?i.value=d:i.value===d&&(i.value=u)},v=u=>{var n;i.value===u&&(i.value="input"),(n=o.value)==null||n.filters.splice(u,1)};W(f,u=>{!u&&i.value===null&&c("input")},{immediate:!0});const p=j(()=>ul(oe.players[m.playerId],27));W(()=>m.playerId,async u=>{u&&(o.value=await oe.getDSPConfig(u))},{immediate:!0});let P=null;const w=u=>{P&&clearTimeout(P),P=setTimeout(async()=>{m.playerId&&await oe.saveDSPConfig(m.playerId,u)},2e3)};return W(o,(u,n)=>{u!==null&&n&&w(n)},{deep:!0}),(u,n)=>o.value?(V(),le("section",Al,[l(he,{color:"transparent",class:"border-b"},{default:a(()=>[l(de,{modelValue:o.value.enabled,"onUpdate:modelValue":n[0]||(n[0]=d=>o.value.enabled=d),"hide-details":"",color:"primary",class:"pl-4"},null,8,["modelValue"]),l(Se,null,{default:a(()=>[C(F(u.$t("settings.dsp.configure_on",{name:p.value})),1)]),_:1})]),_:1}),l(Oe,{class:"pa-4"},{default:a(()=>[o.value.enabled?D("",!0):(V(),S(gl,{key:0,type:"info",class:"mt-4",color:"transparent"},{default:a(()=>[C(F(u.$t("settings.dsp.disabled_message")),1)]),_:1})),l(we,{class:Z([{"justify-center":$(f)},"flex-nowrap"])},{default:a(()=>[!$(f)||i.value===null?(V(),S(ue,{key:0,class:Z(["flex-grow-0 flex-shrink-0",{"border-e pr-4":!$(f)}]),"align-self":"start"},{default:a(()=>[l(hl,{dsp:o.value,selected:i.value,onOnSelect:c,onOnAddFilter:n[1]||(n[1]=d=>h.value=!0),onOnMoveFilter:n[2]||(n[2]=d=>K(d.index,d.direction)),onOnDeleteFilter:v},null,8,["dsp","selected"])]),_:1},8,["class"])):D("",!0),i.value!=null?(V(),S(ue,{key:1,style:{"min-width":"0"}},{default:a(()=>[l(he,{density:"compact",color:u.$vuetify.theme.current.dark?"surface":"surface-light",class:"border-b"},{default:a(()=>[$(f)?(V(),S(O,{key:0,class:"hidden-xs-only",icon:"",onClick:n[3]||(n[3]=d=>i.value=null)},{default:a(()=>[l(L,null,{default:a(()=>n[16]||(n[16]=[C("mdi-arrow-left")])),_:1})]),_:1})):D("",!0),l(Se,null,{default:a(()=>[C(F(q(i.value)),1)]),_:1}),typeof i.value=="number"&&!$(f)&&i.value>0?(V(),S(O,{key:1,icon:"",onClick:n[4]||(n[4]=d=>K(i.value,"up"))},{default:a(()=>[l(L,null,{default:a(()=>n[17]||(n[17]=[C("mdi-arrow-up")])),_:1})]),_:1})):D("",!0),typeof i.value=="number"&&!$(f)&&i.value<o.value.filters.length-1?(V(),S(O,{key:2,icon:"",onClick:n[5]||(n[5]=d=>K(i.value,"down"))},{default:a(()=>[l(L,null,{default:a(()=>n[18]||(n[18]=[C("mdi-arrow-down")])),_:1})]),_:1})):D("",!0),typeof i.value=="number"?(V(),S(de,{key:3,modelValue:o.value.filters[i.value].enabled,"onUpdate:modelValue":n[6]||(n[6]=d=>o.value.filters[i.value].enabled=d),"hide-details":"",color:"primary",class:"mr-4"},null,8,["modelValue"])):D("",!0),typeof i.value=="number"?(V(),S(O,{key:4,icon:"",onClick:n[7]||(n[7]=d=>v(i.value))},{default:a(()=>[l(L,null,{default:a(()=>n[19]||(n[19]=[C("mdi-delete")])),_:1})]),_:1})):D("",!0)]),_:1},8,["color"]),i.value==="input"?(V(),S(Q,{key:0,flat:"",color:u.$vuetify.theme.current.dark?"surface":"surface-light"},{default:a(()=>[l(U,{modelValue:o.value.input_gain,"onUpdate:modelValue":n[8]||(n[8]=d=>o.value.input_gain=d),type:"gain"},null,8,["modelValue"])]),_:1},8,["color"])):i.value==="output"?(V(),S(Q,{key:1,flat:"",color:u.$vuetify.theme.current.dark?"surface":"surface-light"},{default:a(()=>[l(U,{modelValue:o.value.output_gain,"onUpdate:modelValue":n[9]||(n[9]=d=>o.value.output_gain=d),type:"gain"},null,8,["modelValue"]),l(re,null,{default:a(()=>[l(yl,{modelValue:o.value.output_limiter,"onUpdate:modelValue":n[10]||(n[10]=d=>o.value.output_limiter=d),label:u.$t("settings.dsp.enable_output_limiter"),"hide-details":""},null,8,["modelValue","label"])]),_:1})]),_:1},8,["color"])):(V(),S(Q,{key:2,flat:"",color:u.$vuetify.theme.current.dark?"surface":"surface-light"},{default:a(()=>[o.value.filters[i.value].type===$(N).PARAMETRIC_EQ?(V(),S(Fl,{key:0,modelValue:o.value.filters[i.value],"onUpdate:modelValue":n[11]||(n[11]=d=>o.value.filters[i.value]=d)},null,8,["modelValue"])):D("",!0),o.value.filters[i.value].type===$(N).TONE_CONTROL?(V(),S(ql,{key:1,modelValue:o.value.filters[i.value],"onUpdate:modelValue":n[12]||(n[12]=d=>o.value.filters[i.value]=d)},null,8,["modelValue"])):D("",!0)]),_:1},8,["color"]))]),_:1})):D("",!0)]),_:1},8,["class"])]),_:1}),l(vl,{modelValue:h.value,"onUpdate:modelValue":n[15]||(n[15]=d=>h.value=d),"max-width":"300"},{default:a(()=>[l(Q,null,{default:a(()=>[l(dl,null,{default:a(()=>[C(F(u.$t("settings.dsp.filter.add")),1)]),_:1}),l(G,null,{default:a(()=>[l(Ee,{modelValue:T.value,"onUpdate:modelValue":n[13]||(n[13]=d=>T.value=d),items:$(k),label:u.$t("settings.dsp.filter.type")},null,8,["modelValue","items","label"])]),_:1}),l(ml,null,{default:a(()=>[l(xe),l(O,{onClick:n[14]||(n[14]=d=>h.value=!1)},{default:a(()=>[C(F(u.$t("cancel")),1)]),_:1}),l(O,{color:"primary",onClick:z},{default:a(()=>[C(F(u.$t("settings.dsp.filter.add")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])):D("",!0)}});export{Ql as default};
